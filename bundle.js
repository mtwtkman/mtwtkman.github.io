!function(n){function t(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return n[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var e={};return t.m=n,t.c=e,t.p="",t(0)}([function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}var i=e(1),a=r(i),o=e(3),u=r(o),l=e(6),c=r(l),s=e(28),f=r(s),d=e(33),h=r(d);a["default"].route.mode="hash",a["default"].route(document.getElementById("main"),"/",{"/":u["default"],"/blog":c["default"],"/blog/article/:date.../:slug":f["default"],"/blog/tag/:name":h["default"]})},function(n,t,e){var r;(function(n){!function(i,a){"use strict";var o=a(i);"object"==typeof n&&null!=n&&n.exports?n.exports=o:(r=function(){return o}.call(t,e,t,n),!(void 0!==r&&(n.exports=r)))}("undefined"!=typeof window?window:{},function(n,t){"use strict";function e(n){return"function"==typeof n}function r(n){return"[object Object]"===An.call(n)}function i(n){return"[object String]"===An.call(n)}function a(){}function o(n){xn=n.document,kn=n.location,Cn=n.cancelAnimationFrame||n.clearTimeout,jn=n.requestAnimationFrame||n.setTimeout}function u(n,t){for(var e,r=[],i=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g;e=i.exec(t);)if(""===e[1]&&e[2])n.tag=e[2];else if("#"===e[1])n.attrs.id=e[2];else if("."===e[1])r.push(e[2]);else if("["===e[3][0]){var a=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/.exec(e[3]);n.attrs[a[1]]=a[3]||(a[2]?"":!0)}return r}function l(n,t){var e=t?n.slice(1):n;return 1===e.length&&En(e[0])?e[0]:e}function c(n,t,e){var r="class"in t?"class":"className";for(var i in t)On.call(t,i)&&(i===r&&null!=t[i]&&""!==t[i]?(e.push(t[i]),n[i]=""):n[i]=t[i]);e.length&&(n[r]=e.join(" "))}function s(n,t){var e=[].slice.call(arguments,1);if(r(n))return tn(n,e);if(!i(n))throw new Error("selector in m(selector, attrs, children) should be a string");var a=null!=t&&r(t)&&!("tag"in t||"view"in t||"subtree"in t),o=a?t:{},s={tag:"div",attrs:{},children:l(e,a)};return c(s.attrs,o,u(s,n)),s}function f(n,t){for(var e=0;e<n.length&&!t(n[e],e++););}function d(n,t){f(n,function(n,e){return(n=n&&n.attrs)&&null!=n.key&&t(n,e)})}function h(n){try{if(null!=n&&null!=n.toString())return n}catch(t){}return""}function p(n,t,e,r){try{m(n,t,e),t.nodeValue=r}catch(i){}}function g(n){for(var t=0;t<n.length;t++)En(n[t])&&(n=n.concat.apply([],n),t--);return n}function m(n,t,e){n.insertBefore(t,n.childNodes[e]||null)}function v(n,t,e,r){d(n,function(n,r){t[n=n.key]=t[n]?{action:Mn,index:r,from:t[n].index,element:e.nodes[t[n].index]||xn.createElement("div")}:{action:In,index:r}});var i=[];for(var a in t)On.call(t,a)&&i.push(t[a]);var o=i.sort(K),u=new Array(e.length);return u.nodes=e.nodes.slice(),f(o,function(t){var i=t.index;if(t.action===Rn&&(G(e[i].nodes,e[i]),u.splice(i,1)),t.action===In){var a=xn.createElement("div");a.key=n[i].attrs.key,m(r,a,i),u.splice(i,0,{attrs:{key:n[i].attrs.key},nodes:[a]}),u.nodes[i]=a}if(t.action===Mn){var o=t.element,l=r.childNodes[i];l!==o&&null!==o&&r.insertBefore(o,l||null),u[i]=e[t.from],u.nodes[i]=o}}),u}function _(n,t,e,r){var i=n.length!==t.length;return i||d(n,function(n,e){var r=t[e];return i=r&&r.attrs&&r.attrs.key!==n.key}),i?v(n,e,t,r):t}function y(n,t,e){f(n,function(n,r){null!=t[r]&&e.push.apply(e,t[r].nodes)}),f(t.nodes,function(n,r){null!=n.parentNode&&e.indexOf(n)<0&&G([n],[t[r]])}),n.length<t.length&&(t.length=n.length),t.nodes=e}function b(n){var t=0;d(n,function(){return f(n,function(n){(n=n&&n.attrs)&&null==n.key&&(n.key="__mithril__"+t++)}),1})}function w(n,t,e){return n.tag!==t.tag?!0:e.sort().join()!==Object.keys(t.attrs).sort().join()?!0:n.attrs.id!==t.attrs.id?!0:n.attrs.key!==t.attrs.key?!0:"all"===s.redraw.strategy()?!t.configContext||t.configContext.retain!==!0:"diff"===s.redraw.strategy()?t.configContext&&t.configContext.retain===!1:!1}function x(n,t,r){w(n,t,r)&&(t.nodes.length&&G(t.nodes),t.configContext&&e(t.configContext.onunload)&&t.configContext.onunload(),t.controllers&&f(t.controllers,function(n){n.onunload&&n.onunload({preventDefault:a})}))}function k(n,t){return n.attrs.xmlns?n.attrs.xmlns:"svg"===n.tag?"http://www.w3.org/2000/svg":"math"===n.tag?"http://www.w3.org/1998/Math/MathML":t}function j(n,t,e){e.length&&(n.views=t,n.controllers=e,f(e,function(n){if(n.onunload&&n.onunload.$old&&(n.onunload=n.onunload.$old),Tn&&n.onunload){var t=n.onunload;n.onunload=a,n.onunload.$old=t}}))}function C(n,t,r,i,a){if(e(t.attrs.config)){var o=a.configContext=a.configContext||{};n.push(function(){return t.attrs.config.call(t,r,!i,o,a)})}}function O(n,e,r,i,a,o,u,l){var c=n.nodes[0];return i&&V(c,e.tag,e.attrs,n.attrs,a),n.children=B(c,e.tag,t,t,e.children,n.children,!1,0,e.attrs.contenteditable?c:r,a,u),n.nodes.intact=!0,l.length&&(n.views=o,n.controllers=l),c}function A(n,t,e){var r;n.$trusted?r=Z(t,e,n):(r=[xn.createTextNode(n)],t.nodeName in Sn||m(t,r[0],e));var i;return i="string"==typeof n||"number"==typeof n||"boolean"==typeof n?new n.constructor(n):n,i.nodes=r,i}function E(n,t,e,r,i,a){var o=t.nodes;return r&&r===xn.activeElement||(n.$trusted?(G(o,t),o=Z(e,i,n)):"textarea"===a?e.value=n:r?r.innerHTML=n:((1===o[0].nodeType||o.length>1||o[0].nodeValue.trim&&!o[0].nodeValue.trim())&&(G(t.nodes,t),o=[xn.createTextNode(n)]),p(e,o[0],i,n))),t=new n.constructor(n),t.nodes=o,t}function S(n,t,e,r,i,a,o){return n.nodes.length?n.valueOf()!==t.valueOf()||i?E(t,n,r,a,e,o):(n.nodes.intact=!0,n):A(t,r,e)}function R(n){if(n.$trusted){var t=n.match(/<[^\/]|\>\s*[^<]/g);if(null!=t)return t.length}else if(En(n))return n.length;return 1}function I(n,e,r,i,a,o,u,l,c){n=g(n);var s=[],f=e.length===n.length,h=0,p={},m=!1;d(e,function(n,t){m=!0,p[e[t].attrs.key]={action:Rn,index:t}}),b(n),m&&(e=_(n,e,p,r));for(var v=0,w=0,x=n.length;x>w;w++){var k=B(r,a,e,i,n[w],e[v],o,i+h||h,u,l,c);k!==t&&(f=f&&k.nodes.intact,h+=R(k),e[v++]=k)}return f||y(n,e,s),e}function M(n,t,e,r,i){if(null!=t){if(An.call(t)===An.call(n))return t;if(i&&i.nodes){var a=e-r,o=a+(En(n)?n:t.nodes).length;G(i.nodes.slice(a,o),i.slice(a,o))}else t.nodes&&G(t.nodes,t)}return t=new n.constructor,t.tag&&(t={}),t.nodes=[],t}function T(n,t){return n.attrs.is?null==t?xn.createElement(n.tag,n.attrs.is):xn.createElementNS(t,n.tag,n.attrs.is):null==t?xn.createElement(n.tag):xn.createElementNS(t,n.tag)}function L(n,t,e,r){return r?V(t,n.tag,n.attrs,{},e):n.attrs}function P(n,e,r,i,a,o){return null!=n.children&&n.children.length>0?B(e,n.tag,t,t,n.children,r.children,!0,0,n.attrs.contenteditable?e:i,a,o):n.children}function D(n,t,e,r,i,a,o){var u={tag:n.tag,attrs:t,children:e,nodes:[r]};return j(u,a,o),u.children&&!u.children.nodes&&(u.children.nodes=[]),"select"===n.tag&&"value"in n.attrs&&V(r,n.tag,{value:n.attrs.value},{},i),u}function N(n,t,r,i){var a;return a="diff"===s.redraw.strategy()&&n?n.indexOf(t):-1,a>-1?r[a]:e(i)?new i:{}}function $(n,t,e,r){null!=r.onunload&&Pn.map(function(n){return n.handler}).indexOf(r.onunload)<0&&Pn.push({controller:r,handler:r.onunload}),n.push(e),t.push(r)}function z(n,t,e,r,i,a){var o=N(e.views,t,r,n.controller),u=n&&n.attrs&&n.attrs.key;return n=0===Tn||Dn||r&&r.indexOf(o)>-1?n.view(o):{tag:"placeholder"},"retain"===n.subtree?n:(n.attrs=n.attrs||{},n.attrs.key=u,$(a,i,t,o),n)}function F(n,t,e,r){for(var i=t&&t.controllers;null!=n.view;)n=z(n,n.view.$original||n.view,t,i,r,e);return n}function q(n,t,e,r,a,o,u,l){var c=[],s=[];if(n=F(n,t,c,s),"retain"===n.subtree)return t;if(!n.tag&&s.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");n.attrs=n.attrs||{},t.attrs=t.attrs||{};var f=Object.keys(n.attrs),d=f.length>("key"in n.attrs?1:0);if(x(n,t,f),i(n.tag)){var h=0===t.nodes.length;u=k(n,u);var p;if(h){p=T(n,u);var g=L(n,p,u,d),v=P(n,p,t,e,u,l);t=D(n,g,v,p,u,c,s)}else p=O(t,n,e,d,u,c,l,s);return(h||o===!0&&null!=p)&&m(r,p,a),C(l,n,p,h,t),t}}function B(n,t,i,a,o,u,l,c,s,f,d){return o=h(o),"retain"===o.subtree?u:(u=M(o,u,c,a,i),En(o)?I(o,u,n,c,t,l,s,f,d):null!=o&&r(o)?q(o,u,s,n,c,l,f,d):e(o)?u:S(u,o,c,n,l,s,t))}function K(n,t){return n.action-t.action||n.index-t.index}function U(n,t,e){for(var r in t)On.call(t,r)&&(null!=e&&e[r]===t[r]||(n.style[r]=t[r]));for(r in e)On.call(e,r)&&(On.call(t,r)||(n.style[r]=""))}function W(n,t,i,a,o,u){if("config"===t||"key"===t)return!0;if(e(i)&&"on"===t.slice(0,2))n[t]=Q(i,n);else if("style"===t&&null!=i&&r(i))U(n,i,a);else if(null!=u)"href"===t?n.setAttributeNS("http://www.w3.org/1999/xlink","href",i):n.setAttribute("className"===t?"class":t,i);else if(t in n&&!Nn[t])try{"input"===o&&n[t]===i||(n[t]=i)}catch(l){n.setAttribute(t,i)}else n.setAttribute(t,i)}function H(n,t,e,r,i,a,o){if(t in i&&r===e)"value"===t&&"input"===a&&n.value!==e&&(n.value=e);else{i[t]=e;try{return W(n,t,e,r,a,o)}catch(u){if(u.message.indexOf("Invalid argument")<0)throw u}}}function V(n,t,e,r,i){for(var a in e)if(On.call(e,a)&&H(n,a,e[a],r[a],r,t,i))continue;return r}function G(n,t){for(var e=n.length-1;e>-1;e--)if(n[e]&&n[e].parentNode){try{n[e].parentNode.removeChild(n[e])}catch(r){}t=[].concat(t),t[e]&&J(t[e])}n.length&&(n.length=0)}function J(n){n.configContext&&e(n.configContext.onunload)&&(n.configContext.onunload(),n.configContext.onunload=null),n.controllers&&f(n.controllers,function(n){e(n.onunload)&&n.onunload({preventDefault:a})}),n.children&&(En(n.children)?f(n.children,J):n.children.tag&&J(n.children))}function Y(n,t){try{n.appendChild(xn.createRange().createContextualFragment(t))}catch(e){n.insertAdjacentHTML("beforeend",t)}}function Z(n,t,e){var r=n.childNodes[t];if(r){var i=1!==r.nodeType,a=xn.createElement("span");i?(n.insertBefore(a,r||null),a.insertAdjacentHTML("beforebegin",e),n.removeChild(a)):r.insertAdjacentHTML("beforebegin",e)}else Y(n,e);for(var o=[];n.childNodes[t]!==r;)o.push(n.childNodes[t]),t++;return o}function Q(n,t){return function(e){e=e||event,s.redraw.strategy("diff"),s.startComputation();try{return n.call(t,e)}finally{on()}}}function X(n){var t=zn.indexOf(n);return 0>t?zn.push(n)-1:t}function nn(n){function t(){return arguments.length&&(n=arguments[0]),n}return t.toJSON=function(){return n},t}function tn(n,t){function e(){return(n.controller||a).apply(this,t)||this}function r(e){for(var r=[e].concat(t),i=1;i<arguments.length;i++)r.push(arguments[i]);return n.view.apply(n,r)}n.controller&&(e.prototype=n.controller.prototype),r.$original=n.view;var i={controller:e,view:r};return t[0]&&null!=t[0].key&&(i.attrs={key:t[0].key}),i}function en(n,t,e,r){if(!r){s.redraw.strategy("all"),s.startComputation(),Bn[e]=t;var i;i=qn=n?n:n={controller:a};var o=new(n.controller||a);return i===qn&&(Un[e]=o,Kn[e]=n),on(),null===n&&rn(t,e),Un[e]}null==n&&rn(t,e)}function rn(n,t){Bn.splice(t,1),Un.splice(t,1),Kn.splice(t,1),hn(n),zn.splice(X(n),1)}function an(){Vn&&(Vn(),Vn=null),f(Bn,function(n,t){var e=Kn[t];if(Un[t]){var r=[Un[t]];s.render(n,e.view?e.view(Un[t],r):"")}}),Gn&&(Gn(),Gn=null),Wn=null,Hn=new Date,s.redraw.strategy("diff")}function on(){"none"===s.redraw.strategy()?(Tn--,s.redraw.strategy("diff")):s.endComputation()}function un(n){return n.slice(Xn[s.route.mode].length)}function ln(n,t,e){Zn={};var r=e.indexOf("?");-1!==r&&(Zn=dn(e.substr(r+1,e.length)),e=e.substr(0,r));var i=Object.keys(t),a=i.indexOf(e);if(-1!==a)return s.mount(n,t[i[a]]),!0;for(var o in t)if(On.call(t,o)){if(o===e)return s.mount(n,t[o]),!0;var u=new RegExp("^"+o.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(u.test(e))return e.replace(u,function(){var e=o.match(/:[^\/]+/g)||[],r=[].slice.call(arguments,1,-2);f(e,function(n,t){Zn[n.replace(/:|\./g,"")]=decodeURIComponent(r[t])}),s.mount(n,t[o])}),!0}}function cn(n){if(n=n||event,!(n.ctrlKey||n.metaKey||n.shiftKey||2===n.which)){n.preventDefault?n.preventDefault():n.returnValue=!1;var t,e=n.currentTarget||n.srcElement;for(t="pathname"===s.route.mode&&e.search?dn(e.search.slice(1)):{};e&&!/a/i.test(e.nodeName);)e=e.parentNode;Tn=0,s.route(e[s.route.mode].slice(Xn[s.route.mode].length),t)}}function sn(){"hash"!==s.route.mode&&kn.hash?kn.hash=kn.hash:n.scrollTo(0,0)}function fn(n,e){var i={},a=[];for(var o in n)if(On.call(n,o)){var u=e?e+"["+o+"]":o,l=n[o];if(null===l)a.push(encodeURIComponent(u));else if(r(l))a.push(fn(l,u));else if(En(l)){var c=[];i[u]=i[u]||{},f(l,function(n){i[u][n]||(i[u][n]=!0,c.push(encodeURIComponent(u)+"="+encodeURIComponent(n)))}),a.push(c.join("&"))}else l!==t&&a.push(encodeURIComponent(u)+"="+encodeURIComponent(l))}return a.join("&")}function dn(n){if(""===n||null==n)return{};"?"===n.charAt(0)&&(n=n.slice(1));var t=n.split("&"),e={};return f(t,function(n){var t=n.split("="),r=decodeURIComponent(t[0]),i=2===t.length?decodeURIComponent(t[1]):null;null!=e[r]?(En(e[r])||(e[r]=[e[r]]),e[r].push(i)):e[r]=i}),e}function hn(n){var e=X(n);G(n.childNodes,Fn[e]),Fn[e]=t}function pn(n,t){var e=s.prop(t);return n.then(e),e.then=function(e,r){return pn(n.then(e,r),t)},e["catch"]=e.then.bind(null,null),e}function gn(n,t){function i(n){l=n||at,f.map(function(n){l===it?n.resolve(c):n.reject(c)})}function a(n,t,i,a){if((null!=c&&r(c)||e(c))&&e(n))try{var o=0;n.call(c,function(n){o++||(c=n,t())},function(n){o++||(c=n,i())})}catch(u){s.deferred.onerror(u),c=u,i()}else a()}function o(){var r;try{r=c&&c.then}catch(f){return s.deferred.onerror(f),c=f,l=rt,o()}l===rt&&s.deferred.onerror(c),a(r,function(){l=et,o()},function(){l=rt,o()},function(){try{l===et&&e(n)?c=n(c):l===rt&&e(t)&&(c=t(c),l=et)}catch(o){return s.deferred.onerror(o),c=o,i()}c===u?(c=TypeError(),i()):a(r,function(){i(it)},i,function(){i(l===et&&it)})})}var u=this,l=0,c=0,f=[];u.promise={},u.resolve=function(n){return l||(c=n,l=et,o()),u},u.reject=function(n){return l||(c=n,l=rt,o()),u},u.promise.then=function(n,t){var e=new gn(n,t);return l===it?e.resolve(c):l===at?e.reject(c):f.push(e),e.promise}}function mn(n){return n}function vn(e){var r="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),i=xn.createElement("script");n[r]=function(a){i.parentNode.removeChild(i),e.onload({type:"load",target:{responseText:a}}),n[r]=t},i.onerror=function(){return i.parentNode.removeChild(i),e.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),n[r]=t,!1},i.onload=function(){return!1},i.src=e.url+(e.url.indexOf("?")>0?"&":"?")+(e.callbackKey?e.callbackKey:"callback")+"="+r+"&"+fn(e.data||{}),xn.body.appendChild(i)}function _n(t){var r=new n.XMLHttpRequest;if(r.open(t.method,t.url,!0,t.user,t.password),r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300?t.onload({type:"load",target:r}):t.onerror({type:"error",target:r}))},t.serialize===JSON.stringify&&t.data&&"GET"!==t.method&&r.setRequestHeader("Content-Type","application/json; charset=utf-8"),t.deserialize===JSON.parse&&r.setRequestHeader("Accept","application/json, text/*"),e(t.config)){var a=t.config(r,t);null!=a&&(r=a)}var o="GET"!==t.method&&t.data?t.data:"";if(o&&!i(o)&&o.constructor!==n.FormData)throw new Error("Request data should be either be a string or FormData. Check the `serialize` option in `m.request`");return r.send(o),r}function yn(n){return n.dataType&&"jsonp"===n.dataType.toLowerCase()?vn(n):_n(n)}function bn(n,t,e){if("GET"===n.method&&"jsonp"!==n.dataType){var r=n.url.indexOf("?")<0?"?":"&",i=fn(t);n.url+=i?r+i:""}else n.data=e(t)}function wn(n,t){return t&&(n=n.replace(/:[a-z]\w+/gi,function(n){var e=n.slice(1),r=t[e];return delete t[e],r})),n}s.version=function(){return"v0.2.3"};var xn,kn,jn,Cn,On={}.hasOwnProperty,An={}.toString,En=Array.isArray||function(n){return"[object Array]"===An.call(n)},Sn={AREA:1,BASE:1,BR:1,COL:1,COMMAND:1,EMBED:1,HR:1,IMG:1,INPUT:1,KEYGEN:1,LINK:1,META:1,PARAM:1,SOURCE:1,TRACK:1,WBR:1};s.deps=function(t){return o(n=t||window),n},s.deps(n);var Rn=1,In=2,Mn=3,Tn=0;s.startComputation=function(){Tn++},s.endComputation=function(){Tn>1?Tn--:(Tn=0,s.redraw())};var Ln,Pn=[],Dn=!1,Nn={list:1,style:1,form:1,type:1,width:1,height:1},$n={appendChild:function(n){Ln===t&&(Ln=xn.createElement("html")),xn.documentElement&&xn.documentElement!==n?xn.replaceChild(n,xn.documentElement):xn.appendChild(n),this.childNodes=xn.childNodes},insertBefore:function(n){this.appendChild(n)},childNodes:[]},zn=[],Fn={};s.render=function(n,e,r){if(!n)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var i,a=[],o=X(n),u=n===xn;i=u||n===xn.documentElement?$n:n,u&&"html"!==e.tag&&(e={tag:"html",attrs:{},children:e}),Fn[o]===t&&G(i.childNodes),r===!0&&hn(n),Fn[o]=B(i,null,t,t,e,Fn[o],!1,0,null,t,a),f(a,function(n){n()})},s.trust=function(n){return n=new String(n),n.$trusted=!0,n},s.prop=function(n){return(null!=n&&r(n)||e(n))&&e(n.then)?pn(n):nn(n)};var qn,Bn=[],Kn=[],Un=[],Wn=null,Hn=0,Vn=null,Gn=null,Jn=16;s.component=function(n){var t=[].slice.call(arguments,1);return tn(n,t)},s.mount=s.module=function(n,t){if(!n)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var r=Bn.indexOf(n);0>r&&(r=Bn.length);var i=!1,a={preventDefault:function(){i=!0,Vn=Gn=null}};return f(Pn,function(n){n.handler.call(n.controller,a),n.controller.onunload=null}),i?f(Pn,function(n){n.controller.onunload=n.handler}):Pn=[],Un[r]&&e(Un[r].onunload)&&Un[r].onunload(a),en(t,n,r,i)};var Yn=!1;s.redraw=function(t){if(!Yn){Yn=!0,t&&(Dn=!0);try{Wn&&!t?(jn===n.requestAnimationFrame||new Date-Hn>Jn)&&(Wn>0&&Cn(Wn),Wn=jn(an,Jn)):(an(),Wn=jn(function(){Wn=null},Jn))}finally{Yn=Dn=!1}}},s.redraw.strategy=s.prop(),s.withAttr=function(n,t,e){return function(r){r=r||event;var i=r.currentTarget||this,a=e||this,o=n in i?i[n]:i.getAttribute(n);t.call(a,o)}};var Zn,Qn,Xn={pathname:"",hash:"#",search:"?"},nt=a,tt=!1;s.route=function(t,e,r,a){if(0===arguments.length)return Qn;if(3===arguments.length&&i(e)){nt=function(n){var i=Qn=un(n);if(!ln(t,r,i)){if(tt)throw new Error("Ensure the default route matches one of the routes defined in m.route");tt=!0,s.route(e,!0),tt=!1}};var o="hash"===s.route.mode?"onhashchange":"onpopstate";return n[o]=function(){var n=kn[s.route.mode];"pathname"===s.route.mode&&(n+=kn.search),Qn!==un(n)&&nt(n)},Vn=sn,void n[o]()}if(t.addEventListener||t.attachEvent){var u="pathname"!==s.route.mode?kn.pathname:"";return t.href=u+Xn[s.route.mode]+a.attrs.href,void(t.addEventListener?(t.removeEventListener("click",cn),t.addEventListener("click",cn)):(t.detachEvent("onclick",cn),t.attachEvent("onclick",cn)))}if(i(t)){var l=Qn;Qn=t;var c,f=e||{},d=Qn.indexOf("?");c=d>-1?dn(Qn.slice(d+1)):{};for(var h in f)On.call(f,h)&&(c[h]=f[h]);var p,g=fn(c);p=d>-1?Qn.slice(0,d):Qn,g&&(Qn=p+(-1===p.indexOf("?")?"?":"&")+g);var m=(3===arguments.length?r:e)===!0||l===t;if(n.history.pushState){var v=m?"replaceState":"pushState";Vn=sn,Gn=function(){n.history[v](null,xn.title,Xn[s.route.mode]+Qn)},nt(Xn[s.route.mode]+Qn)}else kn[s.route.mode]=Qn,nt(Xn[s.route.mode]+Qn)}},s.route.param=function(n){if(!Zn)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return n?Zn[n]:Zn},s.route.mode="search",s.route.buildQueryString=fn,s.route.parseQueryString=dn,s.deferred=function(){var n=new gn;return n.promise=pn(n.promise),n};var et=1,rt=2,it=3,at=4;return s.deferred.onerror=function(n){if("[object Error]"===An.call(n)&&!/ Error/.test(n.constructor.toString()))throw Tn=0,n},s.sync=function(n){function t(n,t){return function(o){return i[n]=o,t||(a="reject"),0===--r&&(e.promise(i),e[a](i)),o}}var e=s.deferred(),r=n.length,i=new Array(r),a="resolve";return n.length>0?f(n,function(n,e){n.then(t(e,!0),t(e,!1))}):e.resolve([]),e.promise},s.request=function(n){n.background!==!0&&s.startComputation();var t,e,r,i=new gn,a=n.dataType&&"jsonp"===n.dataType.toLowerCase();return a?(t=n.serialize=e=n.deserialize=mn,r=function(n){return n.responseText}):(t=n.serialize=n.serialize||JSON.stringify,e=n.deserialize=n.deserialize||JSON.parse,r=n.extract||function(n){return n.responseText.length||e!==JSON.parse?n.responseText:null}),n.method=(n.method||"GET").toUpperCase(),n.url=wn(n.url,n.data),bn(n,n.data,t),n.onload=n.onerror=function(t){try{t=t||event;var a=e(r(t.target,n));"load"===t.type?(n.unwrapSuccess&&(a=n.unwrapSuccess(a,t.target)),En(a)&&n.type?f(a,function(t,e){a[e]=new n.type(t)}):n.type&&(a=new n.type(a)),i.resolve(a)):(n.unwrapError&&(a=n.unwrapError(a,t.target)),i.reject(a))}catch(o){i.reject(o)}finally{n.background!==!0&&s.endComputation()}},yn(n),i.promise=pn(i.promise,n.initialValue),i.promise},s})}).call(t,e(2)(n))},function(n,t){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children=[],n.webpackPolyfill=1),n}},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}Object.defineProperty(t,"__esModule",{value:!0});var i=e(4),a=r(i),o=e(5),u=r(o);t["default"]={controller:a["default"],view:u["default"]}},function(n,t){"use strict";function e(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=e},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(n){return(0,o["default"])("div#top-header",[(0,o["default"])("figure#img-wrapper",[(0,o["default"])('a[href="/blog"]',{config:o["default"].route},(0,o["default"])('img#top-img[src="../../../assets/img/avatar.png"]'))]),(0,o["default"])("div#social-links",[(0,o["default"])('a[href="https://github.com/mtwtkman"]',(0,o["default"])("i.fa.fa-github-alt.my-i-size")),(0,o["default"])('a[href="https://twitter.com/mtwtkman"]',(0,o["default"])("i.fa.fa-twitter.my-i-size")),(0,o["default"])('a[href="rss.xml"]',(0,o["default"])("i.fa.fa-rss.my-i-size"))])])}Object.defineProperty(t,"__esModule",{value:!0});var a=e(1),o=r(a);t["default"]=i},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}Object.defineProperty(t,"__esModule",{value:!0});var i=e(7),a=r(i),o=e(27),u=r(o);t["default"]={controller:a["default"],view:u["default"]}},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(){return{props:(0,u["default"])()}}Object.defineProperty(t,"__esModule",{value:!0});var a=e(1),o=(r(a),e(8)),u=r(o);t["default"]=i},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(){var n=o["default"].parseYaml();return n.map(function(n){return{title:n.title,date:n.date,href:n.date.split(" ")[0]+"/"+n.slug}})}Object.defineProperty(t,"__esModule",{value:!0});var a=e(9),o=r(a);t["default"]=i},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(){return o["default"].compact(l["default"].split("\n").map(function(n){var t=e(12)("./"+n);return t.publish?t:void 0}))}Object.defineProperty(t,"__esModule",{value:!0});var a=e(10),o=r(a),u=e(11),l=r(u);t["default"]={parseYaml:i}},function(n,t,e){var r;(function(n,i){(function(){function a(n,t){return n.set(t[0],t[1]),n}function o(n,t){return n.add(t),n}function u(n,t,e){var r=e.length;switch(r){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2])}return n.apply(t,e)}function l(n,t,e,r){for(var i=-1,a=n.length;++i<a;){var o=n[i];t(r,o,e(o),n)}return r}function c(n,t){for(var e=-1,r=n.length,i=-1,a=t.length,o=Array(r+a);++e<r;)o[e]=n[e];for(;++i<a;)o[e++]=t[i];return o}function s(n,t){for(var e=-1,r=n.length;++e<r&&t(n[e],e,n)!==!1;);return n}function f(n,t){for(var e=n.length;e--&&t(n[e],e,n)!==!1;);return n}function d(n,t){for(var e=-1,r=n.length;++e<r;)if(!t(n[e],e,n))return!1;return!0}function h(n,t){for(var e=-1,r=n.length,i=-1,a=[];++e<r;){var o=n[e];t(o,e,n)&&(a[++i]=o)}return a}function p(n,t){return!!n.length&&j(n,t,0)>-1}function g(n,t,e){for(var r=-1,i=n.length;++r<i;)if(e(t,n[r]))return!0;return!1}function m(n,t){for(var e=-1,r=n.length,i=Array(r);++e<r;)i[e]=t(n[e],e,n);return i}function v(n,t){for(var e=-1,r=t.length,i=n.length;++e<r;)n[i+e]=t[e];return n}function _(n,t,e,r){var i=-1,a=n.length;for(r&&a&&(e=n[++i]);++i<a;)e=t(e,n[i],i,n);return e}function y(n,t,e,r){var i=n.length;for(r&&i&&(e=n[--i]);i--;)e=t(e,n[i],i,n);return e}function b(n,t){for(var e=-1,r=n.length;++e<r;)if(t(n[e],e,n))return!0;return!1}function w(n,t,e){for(var r=-1,i=n.length;++r<i;){var a=n[r],o=t(a);if(null!=o&&(u===Q?o===o:e(o,u)))var u=o,l=a}return l}function x(n,t,e,r){var i;return e(n,function(n,e,a){return t(n,e,a)?(i=r?e:n,!1):void 0}),i}function k(n,t,e){for(var r=n.length,i=e?r:-1;e?i--:++i<r;)if(t(n[i],i,n))return i;return-1}function j(n,t,e){if(t!==t)return q(n,e);for(var r=e-1,i=n.length;++r<i;)if(n[r]===t)return r;return-1}function C(n,t,e,r,i){return i(n,function(n,i,a){e=r?(r=!1,n):t(e,n,i,a)}),e}function O(n,t){var e=n.length;for(n.sort(t);e--;)n[e]=n[e].value;return n}function A(n,t){for(var e,r=-1,i=n.length;++r<i;){var a=t(n[r]);a!==Q&&(e=e===Q?a:e+a)}return e}function E(n,t){for(var e=-1,r=Array(n);++e<n;)r[e]=t(e);return r}function S(n,t){return m(t,function(t){return[t,n[t]]})}function R(n){return function(t){return n(t)}}function I(n,t){return m(t,function(t){return n[t]})}function M(n,t){for(var e=-1,r=n.length;++e<r&&j(t,n[e],0)>-1;);return e}function T(n,t){for(var e=n.length;e--&&j(t,n[e],0)>-1;);return e}function L(n){return n&&n.Object===Object?n:null}function P(n,t){if(n!==t){var e=null===n,r=n===Q,i=n===n,a=null===t,o=t===Q,u=t===t;if(n>t&&!a||!i||e&&!o&&u||r&&u)return 1;if(t>n&&!e||!u||a&&!r&&i||o&&i)return-1}return 0}function D(n,t,e){for(var r=-1,i=n.criteria,a=t.criteria,o=i.length,u=e.length;++r<o;){var l=P(i[r],a[r]);if(l){if(r>=u)return l;var c=e[r];return l*("desc"==c?-1:1)}}return n.index-t.index}function N(n,t){for(var e=n.length,r=0;e--;)n[e]===t&&r++;return r}function $(n){return ke[n]}function z(n){return je[n]}function F(n){return"\\"+Ae[n]}function q(n,t,e){for(var r=n.length,i=t+(e?0:-1);e?i--:++i<r;){var a=n[i];if(a!==a)return i}return-1}function B(n){var t=!1;if(null!=n&&"function"!=typeof n.toString)try{t=!!(n+"")}catch(e){}return t}function K(n,t){return n="number"==typeof n||St.test(n)?+n:-1,t=null==t?jn:t,n>-1&&n%1==0&&t>n}function U(n){for(var t,e=[];!(t=n.next()).done;)e.push(t.value);return e}function W(n){var t=-1,e=Array(n.size);return n.forEach(function(n,r){e[++t]=[r,n]}),e}function H(n,t){for(var e=-1,r=n.length,i=-1,a=[];++e<r;){var o=n[e];o!==t&&o!==Rn||(n[e]=Rn,a[++i]=e)}return a}function V(n){var t=-1,e=Array(n.size);return n.forEach(function(n){e[++t]=n}),e}function G(n){if(!n||!ge.test(n))return n.length;for(var t=pe.lastIndex=0;pe.test(n);)t++;return t}function J(n){return n.match(pe)}function Y(n){return Ce[n]}function Z(n){function t(n){if(zo(n)&&!ws(n)&&!(n instanceof i)){if(n instanceof r)return n;if(Ul.call(n,"__wrapped__"))return Ti(n)}return new r(n)}function e(){}function r(n,t){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=Q}function i(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=An,this.__views__=[]}function L(){var n=new i(this.__wrapped__);return n.__actions__=$r(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=$r(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=$r(this.__views__),n}function St(){if(this.__filtered__){var n=new i(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function Tt(){var n=this.__wrapped__.value(),t=this.__dir__,e=ws(n),r=0>t,i=e?n.length:0,a=mi(0,i,this.__views__),o=a.start,u=a.end,l=u-o,c=r?u:o-1,s=this.__iteratees__,f=s.length,d=0,h=gc(l,this.__takeCount__);if(!e||vn>i||i==l&&h==l)return Or(n,this.__actions__);var p=[];n:for(;l--&&h>d;){c+=t;for(var g=-1,m=n[c];++g<f;){var v=s[g],_=v.iteratee,y=v.type,b=_(m);if(y==yn)m=b;else if(!b){if(y==_n)continue n;break n}}p[d++]=m}return p}function Lt(){}function Pt(n,t){return Nt(n,t)&&delete n[t]}function Dt(n,t){if(xc){var e=n[t];return e===xn?Q:e}return Ul.call(n,t)?n[t]:Q}function Nt(n,t){return xc?n[t]!==Q:Ul.call(n,t)}function $t(n,t,e){n[t]=xc&&e===Q?xn:e}function zt(n){var t=-1,e=n?n.length:0;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}function Ft(){this.__data__={hash:new Lt,map:yc?new yc:[],string:new Lt}}function qt(n){var t=this.__data__;return ji(n)?Pt("string"==typeof n?t.string:t.hash,n):yc?t.map["delete"](n):ne(t.map,n)}function Bt(n){var t=this.__data__;return ji(n)?Dt("string"==typeof n?t.string:t.hash,n):yc?t.map.get(n):te(t.map,n)}function Kt(n){var t=this.__data__;return ji(n)?Nt("string"==typeof n?t.string:t.hash,n):yc?t.map.has(n):ee(t.map,n)}function Ut(n,t){var e=this.__data__;return ji(n)?$t("string"==typeof n?e.string:e.hash,n,t):yc?e.map.set(n,t):ie(e.map,n,t),this}function Wt(n){var t=-1,e=n?n.length:0;for(this.__data__=new zt;++t<e;)this.push(n[t])}function Ht(n,t){var e=n.__data__;if(ji(t)){var r=e.__data__,i="string"==typeof t?r.string:r.hash;return i[t]===xn}return e.has(t)}function Vt(n){var t=this.__data__;if(ji(n)){var e=t.__data__,r="string"==typeof n?e.string:e.hash;r[n]=xn}else t.set(n,xn)}function Gt(n){var t=-1,e=n?n.length:0;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}function Jt(){this.__data__={array:[],map:null}}function Yt(n){var t=this.__data__,e=t.array;return e?ne(e,n):t.map["delete"](n)}function Zt(n){var t=this.__data__,e=t.array;return e?te(e,n):t.map.get(n)}function Qt(n){var t=this.__data__,e=t.array;return e?ee(e,n):t.map.has(n)}function Xt(n,t){var e=this.__data__,r=e.array;r&&(r.length<vn-1?ie(r,n,t):(e.array=null,e.map=new zt(r)));var i=e.map;return i&&i.set(n,t),this}function ne(n,t){var e=re(n,t);if(0>e)return!1;var r=n.length-1;return e==r?n.pop():lc.call(n,e,1),!0}function te(n,t){var e=re(n,t);return 0>e?Q:n[e][1]}function ee(n,t){return re(n,t)>-1}function re(n,t){for(var e=n.length;e--;)if(bo(n[e][0],t))return e;return-1}function ie(n,t,e){var r=re(n,t);0>r?n.push([t,e]):n[r][1]=e}function ae(n,t,e,r){return n===Q||bo(n,Bl[e])&&!Ul.call(r,e)?t:n}function oe(n,t,e){(e===Q||bo(n[t],e))&&("number"!=typeof t||e!==Q||t in n)||(n[t]=e)}function ue(n,t,e){var r=n[t];Ul.call(n,t)&&bo(r,e)&&(e!==Q||t in n)||(n[t]=e)}function le(n,t,e,r){return Ic(n,function(n,i,a){t(r,n,e(n),a)}),r}function ce(n,t){return n&&zr(t,Cu(t),n)}function se(n,t){for(var e=-1,r=null==n,i=t.length,a=Array(i);++e<i;)a[e]=r?Q:xu(n,t[e]);return a}function fe(n){return Oo(n)?n:[]}function de(n){return"function"==typeof n?n:pl}function pe(n){return ws(n)?n:Mi(n)}function ke(n,t,e){return n===n&&(e!==Q&&(n=e>=n?n:e),t!==Q&&(n=n>=t?n:t)),n}function je(n,t,e,r,i,a){var o;if(e&&(o=i?e(n,r,i,a):e(n)),o!==Q)return o;if(!$o(n))return n;var u=ws(n);if(u){if(o=_i(n),!t)return $r(n,o)}else{var l=gi(n),c=l==Dn||l==Nn;if(xs(n))return Sr(n,t);if(l==Fn||l==In||c&&!i){if(B(n))return i?n:{};if(o=yi(c?{}:n),!t)return qr(n,ce(o,n))}else{if(!xe[l])return i?n:{};o=bi(n,l,t)}}a||(a=new Gt);var f=a.get(n);return f?f:(a.set(n,o),(u?s:ze)(n,function(r,i){ue(o,i,je(r,t,e,i,n,a))}),u?o:qr(n,o))}function Ce(n){var t=Cu(n),e=t.length;return function(r){if(null==r)return!e;for(var i=e;i--;){var a=t[i],o=n[a],u=r[a];if(u===Q&&!(a in Object(r))||!o(u))return!1}return!0}}function Oe(n){return $o(n)?ac(n):{}}function Ae(n,t,e){if("function"!=typeof n)throw new Fl(wn);return uc(function(){n.apply(Q,e)},t)}function Re(n,t,e,r){var i=-1,a=p,o=!0,u=n.length,l=[],c=t.length;if(!u)return l;e&&(t=m(t,R(e))),r?(a=g,o=!1):t.length>=vn&&(a=Ht,o=!1,t=new Wt(t));n:for(;++i<u;){var s=n[i],f=e?e(s):s;if(o&&f===f){for(var d=c;d--;)if(t[d]===f)continue n;l.push(s)}else a(t,f,r)||l.push(s)}return l}function Ie(n,t){var e=!0;return Ic(n,function(n,r,i){return e=!!t(n,r,i)}),e}function Te(n,t,e,r){var i=n.length;for(e=uu(e),0>e&&(e=-e>i?0:i+e),r=r===Q||r>i?i:uu(r),0>r&&(r+=i),r=e>r?0:lu(r);r>e;)n[e++]=t;return n}function Le(n,t){var e=[];return Ic(n,function(n,r,i){t(n,r,i)&&e.push(n)}),e}function Pe(n,t,e,r){r||(r=[]);for(var i=-1,a=n.length;++i<a;){var o=n[i];t>0&&Oo(o)&&(e||ws(o)||ko(o))?t>1?Pe(o,t-1,e,r):v(r,o):e||(r[r.length]=o)}return r}function De(n,t){return null==n?n:Tc(n,t,Ou)}function ze(n,t){return n&&Tc(n,t,Cu)}function Fe(n,t){return n&&Lc(n,t,Cu)}function qe(n,t){
return h(t,function(t){return Po(n[t])})}function Be(n,t){t=ki(t,n)?[t+""]:pe(t);for(var e=0,r=t.length;null!=n&&r>e;)n=n[t[e++]];return e&&e==r?n:Q}function Ke(n,t){return Ul.call(n,t)||"object"==typeof n&&t in n&&null===ec(n)}function Ue(n,t){return t in Object(n)}function We(n,t,e){return n>=gc(t,e)&&n<pc(t,e)}function He(n,t,e){for(var r=e?g:p,i=n.length,a=i,o=Array(i),u=[];a--;){var l=n[a];a&&t&&(l=m(l,R(t))),o[a]=!e&&(t||l.length>=120)?new Wt(a&&l):Q}l=n[0];var c=-1,s=l.length,f=o[0];n:for(;++c<s;){var d=l[c],h=t?t(d):d;if(!(f?Ht(f,h):r(u,h,e))){for(var a=i;--a;){var v=o[a];if(!(v?Ht(v,h):r(n[a],h,e)))continue n}f&&f.push(h),u.push(d)}}return u}function Ve(n,t,e,r){return ze(n,function(n,i,a){t(r,e(n),i,a)}),r}function Ge(n,t,e){ki(t,n)||(t=pe(t),n=Ri(n,t),t=Zi(t));var r=null==n?n:n[t];return null==r?Q:u(r,n,e)}function Je(n,t,e,r,i){return n===t?!0:null==n||null==t||!$o(n)&&!zo(t)?n!==n&&t!==t:Ye(n,t,Je,e,r,i)}function Ye(n,t,e,r,i,a){var o=ws(n),u=ws(t),l=Mn,c=Mn;o||(l=gi(n),l==In?l=Fn:l!=Fn&&(o=nu(n))),u||(c=gi(t),c==In?c=Fn:c!=Fn&&(u=nu(t)));var s=l==Fn&&!B(n),f=c==Fn&&!B(t),d=l==c;if(d&&!o&&!s)return li(n,t,l,e,r,i);var h=i&dn;if(!h){var p=s&&Ul.call(n,"__wrapped__"),g=f&&Ul.call(t,"__wrapped__");if(p||g)return e(p?n.value():n,g?t.value():t,r,i,a)}return d?(a||(a=new Gt),(o?ui:ci)(n,t,e,r,i,a)):!1}function Ze(n,t,e,r){var i=e.length,a=i,o=!r;if(null==n)return!a;for(n=Object(n);i--;){var u=e[i];if(o&&u[2]?u[1]!==n[u[0]]:!(u[0]in n))return!1}for(;++i<a;){u=e[i];var l=u[0],c=n[l],s=u[1];if(o&&u[2]){if(c===Q&&!(l in n))return!1}else{var f=new Gt,d=r?r(c,s,l,n,t,f):Q;if(!(d===Q?Je(s,c,r,fn|dn,f):d))return!1}}return!0}function Qe(n){var t=typeof n;return"function"==t?n:null==n?pl:"object"==t?ws(n)?rr(n[0],n[1]):er(n):xl(n)}function Xe(n){return hc(Object(n))}function nr(n){n=null==n?n:Object(n);var t=[];for(var e in n)t.push(e);return t}function tr(n,t){var e=-1,r=Co(n)?Array(n.length):[];return Ic(n,function(n,i,a){r[++e]=t(n,i,a)}),r}function er(n){var t=di(n);if(1==t.length&&t[0][2]){var e=t[0][0],r=t[0][1];return function(n){return null==n?!1:n[e]===r&&(r!==Q||e in Object(n))}}return function(e){return e===n||Ze(e,n,t)}}function rr(n,t){return function(e){var r=xu(e,n);return r===Q&&r===t?ju(e,n):Je(t,r,Q,fn|dn)}}function ir(n,t,e,r,i){if(n!==t){var a=ws(t)||nu(t)?Q:Ou(t);s(a||t,function(o,u){if(a&&(u=o,o=t[u]),$o(o))i||(i=new Gt),ar(n,t,u,e,ir,r,i);else{var l=r?r(n[u],o,u+"",n,t,i):Q;l===Q&&(l=o),oe(n,u,l)}})}}function ar(n,t,e,r,i,a,o){var u=n[e],l=t[e],c=o.get(l);if(c)return void oe(n,e,c);var s=a?a(u,l,e+"",n,t,o):Q,f=s===Q;f&&(s=l,ws(l)||nu(l)?ws(u)?s=u:Oo(u)?s=$r(u):(f=!1,s=je(l,!0)):Go(l)||ko(l)?ko(u)?s=su(u):!$o(u)||r&&Po(u)?(f=!1,s=je(l,!0)):s=u:f=!1),o.set(l,s),f&&i(s,l,r,a,o),oe(n,e,s)}function or(n,t,e){var r=-1,i=fi();t=m(t.length?t:Array(1),function(n){return i(n)});var a=tr(n,function(n,e,i){var a=m(t,function(t){return t(n)});return{criteria:a,index:++r,value:n}});return O(a,function(n,t){return D(n,t,e)})}function ur(n,t){return n=Object(n),_(t,function(t,e){return e in n&&(t[e]=n[e]),t},{})}function lr(n,t){var e={};return De(n,function(n,r){t(n,r)&&(e[r]=n)}),e}function cr(n){return function(t){return null==t?Q:t[n]}}function sr(n){return function(t){return Be(t,n)}}function fr(n,t){return dr(n,t)}function dr(n,t,e){var r=-1,i=t.length,a=n;for(e&&(a=m(n,function(n){return e(n)}));++r<i;)for(var o=0,u=t[r],l=e?e(u):u;(o=j(a,l,o))>-1;)a!==n&&lc.call(a,o,1),lc.call(n,o,1);return n}function hr(n,t){for(var e=n?t.length:0,r=e-1;e--;){var i=t[e];if(r==e||i!=a){var a=i;if(K(i))lc.call(n,i,1);else if(ki(i,n))delete n[i];else{var o=pe(i),u=Ri(n,o);null!=u&&delete u[Zi(o)]}}}return n}function pr(n,t){return n+sc(vc()*(t-n+1))}function gr(n,t,e,r){for(var i=-1,a=pc(cc((t-n)/(e||1)),0),o=Array(a);a--;)o[r?a:++i]=n,n+=e;return o}function mr(n,t,e,r){t=ki(t,n)?[t+""]:pe(t);for(var i=-1,a=t.length,o=a-1,u=n;null!=u&&++i<a;){var l=t[i];if($o(u)){var c=e;if(i!=o){var s=u[l];c=r?r(s,l,u):Q,c===Q&&(c=null==s?K(t[i+1])?[]:{}:s)}ue(u,l,c)}u=u[l]}return n}function vr(n,t,e){var r=-1,i=n.length;0>t&&(t=-t>i?0:i+t),e=e>i?i:e,0>e&&(e+=i),i=t>e?0:e-t>>>0,t>>>=0;for(var a=Array(i);++r<i;)a[r]=n[r+t];return a}function _r(n,t){var e;return Ic(n,function(n,r,i){return e=t(n,r,i),!e}),!!e}function yr(n,t,e){var r=0,i=n?n.length:r;if("number"==typeof t&&t===t&&Sn>=i){for(;i>r;){var a=r+i>>>1,o=n[a];(e?t>=o:t>o)&&null!==o?r=a+1:i=a}return i}return br(n,t,pl,e)}function br(n,t,e,r){t=e(t);for(var i=0,a=n?n.length:0,o=t!==t,u=null===t,l=t===Q;a>i;){var c=sc((i+a)/2),s=e(n[c]),f=s!==Q,d=s===s;if(o)var h=d||r;else h=u?d&&f&&(r||null!=s):l?d&&(r||f):null==s?!1:r?t>=s:t>s;h?i=c+1:a=c}return gc(a,En)}function wr(n){return xr(n)}function xr(n,t){for(var e=0,r=n.length,i=n[0],a=t?t(i):i,o=a,u=0,l=[i];++e<r;)i=n[e],a=t?t(i):i,bo(a,o)||(o=a,l[++u]=i);return l}function kr(n,t,e){var r=-1,i=p,a=n.length,o=!0,u=[],l=u;if(e)o=!1,i=g;else if(a>=vn){var c=t?null:Dc(n);if(c)return V(c);o=!1,i=Ht,l=new Wt}else l=t?[]:u;n:for(;++r<a;){var s=n[r],f=t?t(s):s;if(o&&f===f){for(var d=l.length;d--;)if(l[d]===f)continue n;t&&l.push(f),u.push(s)}else i(l,f,e)||(l!==u&&l.push(f),u.push(s))}return u}function jr(n,t){t=ki(t,n)?[t+""]:pe(t),n=Ri(n,t);var e=Zi(t);return null!=n&&ku(n,e)?delete n[e]:!0}function Cr(n,t,e,r){for(var i=n.length,a=r?i:-1;(r?a--:++a<i)&&t(n[a],a,n););return e?vr(n,r?0:a,r?a+1:i):vr(n,r?a+1:0,r?i:a)}function Or(n,t){var e=n;return e instanceof i&&(e=e.value()),_(t,function(n,t){return t.func.apply(t.thisArg,v([n],t.args))},e)}function Ar(n,t,e){for(var r=-1,i=n.length;++r<i;)var a=a?v(Re(a,n[r],t,e),Re(n[r],a,t,e)):n[r];return a&&a.length?kr(a,t,e):[]}function Er(n,t,e){for(var r=-1,i=n.length,a=t.length,o={};++r<i;)e(o,n[r],a>r?t[r]:Q);return o}function Sr(n,t){if(t)return n.slice();var e=n.constructor,r=new e(n.length);return n.copy(r),r}function Rr(n){var t=n.constructor,e=new t(n.byteLength),r=new Xl(e);return r.set(new Xl(n)),e}function Ir(n){var t=n.constructor;return _(W(n),a,new t)}function Mr(n){var t=n.constructor,e=new t(n.source,kt.exec(n));return e.lastIndex=n.lastIndex,e}function Tr(n){var t=n.constructor;return _(V(n),o,new t)}function Lr(n){return Ql?Object(Ec.call(n)):{}}function Pr(n,t){var e=n.buffer,r=t?Rr(e):e,i=n.constructor;return new i(r,n.byteOffset,n.length)}function Dr(n,t,e,r){for(var i=-1,a=n.length,o=e.length,u=-1,l=t.length,c=pc(a-o,0),s=Array(l+c),f=!r;++u<l;)s[u]=t[u];for(;++i<o;)(f||a>i)&&(s[e[i]]=n[i]);for(;c--;)s[u++]=n[i++];return s}function Nr(n,t,e,r){for(var i=-1,a=n.length,o=-1,u=e.length,l=-1,c=t.length,s=pc(a-u,0),f=Array(s+c),d=!r;++i<s;)f[i]=n[i];for(var h=i;++l<c;)f[h+l]=t[l];for(;++o<u;)(d||a>i)&&(f[h+e[o]]=n[i++]);return f}function $r(n,t){var e=-1,r=n.length;for(t||(t=Array(r));++e<r;)t[e]=n[e];return t}function zr(n,t,e){return Fr(n,t,e)}function Fr(n,t,e,r){e||(e={});for(var i=-1,a=t.length;++i<a;){var o=t[i],u=r?r(e[o],n[o],o,e,n):n[o];ue(e,o,u)}return e}function qr(n,t){return zr(n,zc(n),t)}function Br(n,t){return function(e,r){var i=ws(e)?l:le,a=t?t():{};return i(e,n,fi(r),a)}}function Kr(n){return co(function(t,e){var r=-1,i=e.length,a=i>1?e[i-1]:Q,o=i>2?e[2]:Q;for(a="function"==typeof a?(i--,a):Q,o&&xi(e[0],e[1],o)&&(a=3>i?Q:a,i=1),t=Object(t);++r<i;){var u=e[r];u&&n(t,u,r,a)}return t})}function Ur(n,t){return function(e,r){if(null==e)return e;if(!Co(e))return n(e,r);for(var i=e.length,a=t?i:-1,o=Object(e);(t?a--:++a<i)&&r(o[a],a,o)!==!1;);return e}}function Wr(n){return function(t,e,r){for(var i=-1,a=Object(t),o=r(t),u=o.length;u--;){var l=o[n?u:++i];if(e(a[l],l,a)===!1)break}return t}}function Hr(n,t,e){function r(){var t=this&&this!==Ne&&this instanceof r?a:n;return t.apply(i?e:this,arguments)}var i=t&nn,a=Jr(n);return r}function Vr(n){return function(t){t=du(t);var e=ge.test(t)?J(t):Q,r=e?e[0]:t.charAt(0),i=e?e.slice(1).join(""):t.slice(1);return r[n]()+i}}function Gr(n){return function(t){return _(sl(Uu(t)),n,"")}}function Jr(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=Oe(n.prototype),r=n.apply(e,t);return $o(r)?r:e}}function Yr(n,t,e){function r(){for(var a=arguments.length,o=Array(a),l=a,c=pi(r);l--;)o[l]=arguments[l];var s=3>a&&o[0]!==c&&o[a-1]!==c?[]:H(o,c);if(a-=s.length,e>a)return ii(n,t,Qr,r.placeholder,Q,o,s,Q,Q,e-a);var f=this&&this!==Ne&&this instanceof r?i:n;return u(f,this,o)}var i=Jr(n);return r}function Zr(n){return co(function(t){t=Pe(t,1);var e=t.length,i=e,a=r.prototype.thru;for(n&&t.reverse();i--;){var o=t[i];if("function"!=typeof o)throw new Fl(wn);if(a&&!u&&"wrapper"==si(o))var u=new r([],!0)}for(i=u?i:e;++i<e;){o=t[i];var l=si(o),c="wrapper"==l?Nc(o):Q;u=c&&Ci(c[0])&&c[1]==(ln|rn|on|cn)&&!c[4].length&&1==c[9]?u[si(c[0])].apply(u,c[3]):1==o.length&&Ci(o)?u[l]():u.thru(o)}return function(){var n=arguments,r=n[0];if(u&&1==n.length&&ws(r)&&r.length>=vn)return u.plant(r).value();for(var i=0,a=e?t[i].apply(this,n):r;++i<e;)a=t[i].call(this,a);return a}})}function Qr(n,t,e,r,i,a,o,u,l,c){function s(){for(var v=arguments.length,_=v,y=Array(v);_--;)y[_]=arguments[_];if(p)var b=pi(s),w=N(y,b);if(r&&(y=Dr(y,r,i,p)),a&&(y=Nr(y,a,o,p)),v-=w,p&&c>v){var x=H(y,b);return ii(n,t,Qr,s.placeholder,e,y,x,u,l,c-v)}var k=d?e:this,j=h?k[n]:n;return v=y.length,u?y=Ii(y,u):g&&v>1&&y.reverse(),f&&v>l&&(y.length=l),this&&this!==Ne&&this instanceof s&&(j=m||Jr(j)),j.apply(k,y)}var f=t&ln,d=t&nn,h=t&tn,p=t&(rn|an),g=t&sn,m=h?Q:Jr(n);return s}function Xr(n,t){return function(e,r){return Ve(e,n,t(r),{})}}function ni(n){return co(function(t){return t=m(Pe(t,1),fi()),co(function(e){var r=this;return n(t,function(n){return u(n,r,e)})})})}function ti(n,t,e){t=uu(t);var r=G(n);if(!t||r>=t)return"";var i=t-r;e=e===Q?" ":e+"";var a=Qu(e,cc(i/G(e)));return ge.test(e)?J(a).slice(0,i).join(""):a.slice(0,i)}function ei(n,t,e,r){function i(){for(var t=-1,l=arguments.length,c=-1,s=r.length,f=Array(s+l),d=this&&this!==Ne&&this instanceof i?o:n;++c<s;)f[c]=r[c];for(;l--;)f[c++]=arguments[++t];return u(d,a?e:this,f)}var a=t&nn,o=Jr(n);return i}function ri(n){return function(t,e,r){return r&&"number"!=typeof r&&xi(t,e,r)&&(e=r=Q),t=cu(t),t=t===t?t:0,e===Q?(e=t,t=0):e=cu(e)||0,r=r===Q?e>t?1:-1:cu(r)||0,gr(t,e,r,n)}}function ii(n,t,e,r,i,a,o,u,l,c){var s=t&rn,f=u?$r(u):Q,d=s?o:Q,h=s?Q:o,p=s?a:Q,g=s?Q:a;t|=s?on:un,t&=~(s?un:on),t&en||(t&=~(nn|tn));var m=[n,t,i,p,d,g,h,f,l,c],v=e.apply(Q,m);return Ci(n)&&Fc(v,m),v.placeholder=r,v}function ai(n){var t=$l[n];return function(n,e){if(n=cu(n),e=uu(e)){var r=(du(n)+"e").split("e"),i=t(r[0]+"e"+(+r[1]+e));return r=(du(i)+"e").split("e"),+(r[0]+"e"+(+r[1]-e))}return t(n)}}function oi(n,t,e,r,i,a,o,u){var l=t&tn;if(!l&&"function"!=typeof n)throw new Fl(wn);var c=r?r.length:0;if(c||(t&=~(on|un),r=i=Q),o=o===Q?o:pc(uu(o),0),u=u===Q?u:uu(u),c-=i?i.length:0,t&un){var s=r,f=i;r=i=Q}var d=l?Q:Nc(n),h=[n,t,e,r,i,s,f,a,o,u];if(d&&Ei(h,d),n=h[0],t=h[1],e=h[2],r=h[3],i=h[4],u=h[9]=null==h[9]?l?0:n.length:pc(h[9]-c,0),!u&&t&(rn|an)&&(t&=~(rn|an)),t&&t!=nn)p=t==rn||t==an?Yr(n,t,u):t!=on&&t!=(nn|on)||i.length?Qr.apply(Q,h):ei(n,t,e,r);else var p=Hr(n,t,e);var g=d?Pc:Fc;return g(p,h)}function ui(n,t,e,r,i,a){var o=-1,u=i&dn,l=i&fn,c=n.length,s=t.length;if(c!=s&&!(u&&s>c))return!1;var f=a.get(n);if(f)return f==t;var d=!0;for(a.set(n,t);++o<c;){var h=n[o],p=t[o];if(r)var g=u?r(p,h,o,t,n,a):r(h,p,o,n,t,a);if(g!==Q){if(g)continue;d=!1;break}if(l){if(!b(t,function(n){return h===n||e(h,n,r,i,a)})){d=!1;break}}else if(h!==p&&!e(h,p,r,i,a)){d=!1;break}}return a["delete"](n),d}function li(n,t,e,r,i,a){switch(e){case Vn:return!(n.byteLength!=t.byteLength||!r(new Xl(n),new Xl(t)));case Tn:case Ln:return+n==+t;case Pn:return n.name==t.name&&n.message==t.message;case zn:return n!=+n?t!=+t:n==+t;case qn:case Kn:return n==t+"";case $n:var o=W;case Bn:var u=a&dn;return o||(o=V),(u||n.size==t.size)&&r(o(n),o(t),i,a|fn);case Un:return!!Ql&&Ec.call(n)==Ec.call(t)}return!1}function ci(n,t,e,r,i,a){var o=i&dn,u=Cu(n),l=u.length,c=Cu(t),s=c.length;if(l!=s&&!o)return!1;for(var f=l;f--;){var d=u[f];if(!(o?d in t:Ke(t,d)))return!1}var h=a.get(n);if(h)return h==t;var p=!0;a.set(n,t);for(var g=o;++f<l;){d=u[f];var m=n[d],v=t[d];if(r)var _=o?r(v,m,d,t,n,a):r(m,v,d,n,t,a);if(!(_===Q?m===v||e(m,v,r,i,a):_)){p=!1;break}g||(g="constructor"==d)}if(p&&!g){var y=n.constructor,b=t.constructor;y!=b&&"constructor"in n&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return a["delete"](n),p}function si(n){for(var t=n.name+"",e=Rc[t],r=Ul.call(Rc,t)?e.length:0;r--;){var i=e[r],a=i.func;if(null==a||a==n)return i.name}return t}function fi(){var n=t.iteratee||gl;return n=n===gl?Qe:n,arguments.length?n(arguments[0],arguments[1]):n}function di(n){for(var t=Lu(n),e=t.length;e--;)t[e][2]=Ai(t[e][1]);return t}function hi(n,t){var e=null==n?Q:n[t];return Uo(e)?e:Q}function pi(n){var e=Ul.call(t,"placeholder")?t:n;return e.placeholder}function gi(n){return Vl.call(n)}function mi(n,t,e){for(var r=-1,i=e.length;++r<i;){var a=e[r],o=a.size;switch(a.type){case"drop":n+=o;break;case"dropRight":t-=o;break;case"take":t=gc(t,n+o);break;case"takeRight":n=pc(n,t-o)}}return{start:n,end:t}}function vi(n,t,e){if(null==n)return!1;var r=e(n,t);r||ki(t)||(t=pe(t),n=Ri(n,t),null!=n&&(t=Zi(t),r=e(n,t)));var i=n?n.length:Q;return r||!!i&&No(i)&&K(t,i)&&(ws(n)||Qo(n)||ko(n))}function _i(n){var t=n.length,e=n.constructor(t);return t&&"string"==typeof n[0]&&Ul.call(n,"index")&&(e.index=n.index,e.input=n.input),e}function yi(n){return Po(n.constructor)&&!Oi(n)?Oe(ec(n)):{}}function bi(n,t,e){var r=n.constructor;switch(t){case Vn:return Rr(n);case Tn:case Ln:return new r(+n);case Gn:case Jn:case Yn:case Zn:case Qn:case Xn:case nt:case tt:case et:return Pr(n,e);case $n:return Ir(n);case zn:case Kn:return new r(n);case qn:return Mr(n);case Bn:return Tr(n);case Un:return Lr(n)}}function wi(n){var t=n?n.length:Q;return No(t)&&(ws(n)||Qo(n)||ko(n))?E(t,String):null}function xi(n,t,e){if(!$o(e))return!1;var r=typeof t;return("number"==r?Co(e)&&K(t,e.length):"string"==r&&t in e)?bo(e[t],n):!1}function ki(n,t){return"number"==typeof n?!0:!ws(n)&&(pt.test(n)||!ht.test(n)||null!=t&&n in Object(t))}function ji(n){var t=typeof n;return"number"==t||"boolean"==t||"string"==t&&"__proto__"!=n||null==n}function Ci(n){var e=si(n),r=t[e];if("function"!=typeof r||!(e in i.prototype))return!1;if(n===r)return!0;var a=Nc(r);return!!a&&n===a[0]}function Oi(n){var t=n&&n.constructor,e=Po(t)&&t.prototype||Bl;return n===e}function Ai(n){return n===n&&!$o(n)}function Ei(n,t){var e=n[1],r=t[1],i=e|r,a=(nn|tn|ln)>i,o=r==ln&&e==rn||r==ln&&e==cn&&n[7].length<=t[8]||r==(ln|cn)&&t[7].length<=t[8]&&e==rn;if(!a&&!o)return n;r&nn&&(n[2]=t[2],i|=e&nn?0:en);var u=t[3];if(u){var l=n[3];n[3]=l?Dr(l,u,t[4]):$r(u),n[4]=l?H(n[3],Rn):$r(t[4])}return u=t[5],u&&(l=n[5],n[5]=l?Nr(l,u,t[6]):$r(u),n[6]=l?H(n[5],Rn):$r(t[6])),u=t[7],u&&(n[7]=$r(u)),r&ln&&(n[8]=null==n[8]?t[8]:gc(n[8],t[8])),null==n[9]&&(n[9]=t[9]),n[0]=t[0],n[1]=i,n}function Si(n,t,e,r,i,a){return $o(n)&&$o(t)&&(a.set(t,n),ir(n,t,Q,Si,a)),n}function Ri(n,t){return 1==t.length?n:xu(n,vr(t,0,-1))}function Ii(n,t){for(var e=n.length,r=gc(t.length,e),i=$r(n);r--;){var a=t[r];n[r]=K(a,e)?i[a]:Q}return n}function Mi(n){var t=[];return du(n).replace(gt,function(n,e,r,i){t.push(r?i.replace(wt,"$1"):e||n)}),t}function Ti(n){if(n instanceof i)return n.clone();var t=new r(n.__wrapped__,n.__chain__);return t.__actions__=$r(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}function Li(n,t){t=pc(uu(t),0);var e=n?n.length:0;if(!e||1>t)return[];for(var r=0,i=-1,a=Array(cc(e/t));e>r;)a[++i]=vr(n,r,r+=t);return a}function Pi(n){for(var t=-1,e=n?n.length:0,r=-1,i=[];++t<e;){var a=n[t];a&&(i[++r]=a)}return i}function Di(n,t,e){var r=n?n.length:0;return r?(t=e||t===Q?1:uu(t),vr(n,0>t?0:t,r)):[]}function Ni(n,t,e){var r=n?n.length:0;return r?(t=e||t===Q?1:uu(t),t=r-t,vr(n,0,0>t?0:t)):[]}function $i(n,t){return n&&n.length?Cr(n,fi(t,3),!0,!0):[]}function zi(n,t){return n&&n.length?Cr(n,fi(t,3),!0):[]}function Fi(n,t,e,r){var i=n?n.length:0;return i?(e&&"number"!=typeof e&&xi(n,t,e)&&(e=0,r=i),Te(n,t,e,r)):[]}function qi(n,t){return n&&n.length?k(n,fi(t,3)):-1}function Bi(n,t){return n&&n.length?k(n,fi(t,3),!0):-1}function Ki(n){var t=n?n.length:0;return t?Pe(n,1):[]}function Ui(n){var t=n?n.length:0;return t?Pe(n,kn):[]}function Wi(n,t){var e=n?n.length:0;return e?(t=t===Q?1:uu(t),Pe(n,t)):[]}function Hi(n){for(var t=-1,e=n?n.length:0,r={};++t<e;){var i=n[t];r[i[0]]=i[1]}return r}function Vi(n){return n?n[0]:Q}function Gi(n,t,e){var r=n?n.length:0;return r?(e=uu(e),0>e&&(e=pc(r+e,0)),j(n,t,e)):-1}function Ji(n){return Ni(n,1)}function Yi(n,t){return n?dc.call(n,t):""}function Zi(n){var t=n?n.length:0;return t?n[t-1]:Q}function Qi(n,t,e){var r=n?n.length:0;if(!r)return-1;var i=r;if(e!==Q&&(i=uu(e),i=(0>i?pc(r+i,0):gc(i,r-1))+1),t!==t)return q(n,i,!0);for(;i--;)if(n[i]===t)return i;return-1}function Xi(n,t){return n&&n.length&&t&&t.length?fr(n,t):n}function na(n,t,e){return n&&n.length&&t&&t.length?dr(n,t,fi(e)):n}function ta(n,t){var e=[];if(!n||!n.length)return e;var r=-1,i=[],a=n.length;for(t=fi(t,3);++r<a;){var o=n[r];t(o,r,n)&&(e.push(o),i.push(r))}return hr(n,i),e}function ea(n){return n?_c.call(n):n}function ra(n,t,e){var r=n?n.length:0;return r?(e&&"number"!=typeof e&&xi(n,t,e)?(t=0,e=r):(t=null==t?0:uu(t),e=e===Q?r:uu(e)),vr(n,t,e)):[]}function ia(n,t){return yr(n,t)}function aa(n,t,e){return br(n,t,fi(e))}function oa(n,t){var e=n?n.length:0;if(e){var r=yr(n,t);if(e>r&&bo(n[r],t))return r}return-1}function ua(n,t){return yr(n,t,!0)}function la(n,t,e){return br(n,t,fi(e),!0)}function ca(n,t){var e=n?n.length:0;if(e){var r=yr(n,t,!0)-1;if(bo(n[r],t))return r}return-1}function sa(n){return n&&n.length?wr(n):[]}function fa(n,t){return n&&n.length?xr(n,fi(t)):[]}function da(n){return Di(n,1)}function ha(n,t,e){return n&&n.length?(t=e||t===Q?1:uu(t),vr(n,0,0>t?0:t)):[]}function pa(n,t,e){var r=n?n.length:0;return r?(t=e||t===Q?1:uu(t),t=r-t,vr(n,0>t?0:t,r)):[]}function ga(n,t){return n&&n.length?Cr(n,fi(t,3),!1,!0):[]}function ma(n,t){return n&&n.length?Cr(n,fi(t,3)):[]}function va(n){return n&&n.length?kr(n):[]}function _a(n,t){return n&&n.length?kr(n,fi(t)):[]}function ya(n,t){return n&&n.length?kr(n,Q,t):[]}function ba(n){if(!n||!n.length)return[];var t=0;return n=h(n,function(n){return Oo(n)?(t=pc(n.length,t),!0):void 0}),E(t,function(t){return m(n,cr(t))})}function wa(n,t){if(!n||!n.length)return[];var e=ba(n);return null==t?e:m(e,function(n){return u(t,Q,n)})}function xa(n,t){return Er(n||[],t||[],ue)}function ka(n,t){return Er(n||[],t||[],mr)}function ja(n){var e=t(n);return e.__chain__=!0,e}function Ca(n,t){return t(n),n}function Oa(n,t){return t(n)}function Aa(){return ja(this)}function Ea(){return new r(this.value(),this.__chain__)}function Sa(n){return this.map(n).flatten()}function Ra(){this.__values__===Q&&(this.__values__=ou(this.value()));var n=this.__index__>=this.__values__.length,t=n?Q:this.__values__[this.__index__++];return{done:n,value:t}}function Ia(){return this}function Ma(n){for(var t,r=this;r instanceof e;){var i=Ti(r);i.__index__=0,i.__values__=Q,t?a.__wrapped__=i:t=i;var a=i;r=r.__wrapped__}return a.__wrapped__=n,t}function Ta(){var n=this.__wrapped__;if(n instanceof i){var t=n;return this.__actions__.length&&(t=new i(this)),t=t.reverse(),t.__actions__.push({func:Oa,args:[ea],thisArg:Q}),new r(t,this.__chain__)}return this.thru(ea)}function La(){return Or(this.__wrapped__,this.__actions__)}function Pa(n,t,e){var r=ws(n)?d:Ie;return e&&xi(n,t,e)&&(t=Q),r(n,fi(t,3))}function Da(n,t){var e=ws(n)?h:Le;return e(n,fi(t,3))}function Na(n,t){if(t=fi(t,3),ws(n)){var e=k(n,t);return e>-1?n[e]:Q}return x(n,t,Ic)}function $a(n,t){if(t=fi(t,3),ws(n)){var e=k(n,t,!0);return e>-1?n[e]:Q}return x(n,t,Mc)}function za(n,t){return Pe(Ka(n,t),1)}function Fa(n,t){return"function"==typeof t&&ws(n)?s(n,t):Ic(n,de(t))}function qa(n,t){return"function"==typeof t&&ws(n)?f(n,t):Mc(n,de(t))}function Ba(n,t,e,r){n=Co(n)?n:$u(n),e=e&&!r?uu(e):0;var i=n.length;return 0>e&&(e=pc(i+e,0)),Qo(n)?i>=e&&n.indexOf(t,e)>-1:!!i&&j(n,t,e)>-1}function Ka(n,t){var e=ws(n)?m:tr;return e(n,fi(t,3))}function Ua(n,t,e,r){return null==n?[]:(ws(t)||(t=null==t?[]:[t]),e=r?Q:e,ws(e)||(e=null==e?[]:[e]),or(n,t,e))}function Wa(n,t,e){var r=ws(n)?_:C,i=arguments.length<3;return r(n,fi(t,4),e,i,Ic)}function Ha(n,t,e){var r=ws(n)?y:C,i=arguments.length<3;return r(n,fi(t,4),e,i,Mc)}function Va(n,t){var e=ws(n)?h:Le;return t=fi(t,3),e(n,function(n,e,r){return!t(n,e,r)})}function Ga(n){var t=Co(n)?n:$u(n),e=t.length;return e>0?t[pr(0,e-1)]:Q}function Ja(n,t){var e=-1,r=ou(n),i=r.length,a=i-1;for(t=ke(uu(t),0,i);++e<t;){var o=pr(e,a),u=r[o];r[o]=r[e],r[e]=u}return r.length=t,r}function Ya(n){return Ja(n,An)}function Za(n){if(null==n)return 0;if(Co(n)){var t=n.length;return t&&Qo(n)?G(n):t}return Cu(n).length}function Qa(n,t,e){var r=ws(n)?b:_r;return e&&xi(n,t,e)&&(t=Q),r(n,fi(t,3))}function Xa(n,t){if("function"!=typeof t)throw new Fl(wn);return n=uu(n),function(){return--n<1?t.apply(this,arguments):void 0}}function no(n,t,e){return t=e?Q:t,t=n&&null==t?n.length:t,oi(n,ln,Q,Q,Q,Q,t)}function to(n,t){var e;if("function"!=typeof t)throw new Fl(wn);return n=uu(n),function(){return--n>0&&(e=t.apply(this,arguments)),1>=n&&(t=Q),e}}function eo(n,t,e){t=e?Q:t;var r=oi(n,rn,Q,Q,Q,Q,Q,t);return r.placeholder=eo.placeholder,r}function ro(n,t,e){t=e?Q:t;var r=oi(n,an,Q,Q,Q,Q,Q,t);return r.placeholder=ro.placeholder,r}function io(n,t,e){function r(){p&&nc(p),s&&nc(s),m=0,c=s=h=p=g=Q}function i(t,e){e&&nc(e),s=p=g=Q,t&&(m=ds(),f=n.apply(h,c),p||s||(c=h=Q))}function a(){var n=t-(ds()-d);0>=n||n>t?i(g,s):p=uc(a,n)}function o(){return(p&&g||s&&y)&&(f=n.apply(h,c)),r(),f}function u(){i(y,p)}function l(){if(c=arguments,d=ds(),h=this,g=y&&(p||!v),_===!1)var e=v&&!p;else{m||s||v||(m=d);var r=_-(d-m),i=(0>=r||r>_)&&(v||s);i?(s&&(s=nc(s)),m=d,f=n.apply(h,c)):s||(s=uc(u,r))}return i&&p?p=nc(p):p||t===_||(p=uc(a,t)),e&&(i=!0,f=n.apply(h,c)),!i||p||s||(c=h=Q),f}var c,s,f,d,h,p,g,m=0,v=!1,_=!1,y=!0;if("function"!=typeof n)throw new Fl(wn);return t=cu(t)||0,$o(e)&&(v=!!e.leading,_="maxWait"in e&&pc(cu(e.maxWait)||0,t),y="trailing"in e?!!e.trailing:y),l.cancel=r,l.flush=o,l}function ao(n){return oi(n,sn)}function oo(n,t){if("function"!=typeof n||t&&"function"!=typeof t)throw new Fl(wn);var e=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=e.cache;if(a.has(i))return a.get(i);var o=n.apply(this,r);return e.cache=a.set(i,o),o};return e.cache=new oo.Cache,e}function uo(n){if("function"!=typeof n)throw new Fl(wn);return function(){return!n.apply(this,arguments)}}function lo(n){return to(2,n)}function co(n,t){if("function"!=typeof n)throw new Fl(wn);return t=pc(t===Q?n.length-1:uu(t),0),function(){for(var e=arguments,r=-1,i=pc(e.length-t,0),a=Array(i);++r<i;)a[r]=e[t+r];switch(t){case 0:return n.call(this,a);case 1:return n.call(this,e[0],a);case 2:return n.call(this,e[0],e[1],a)}var o=Array(t+1);for(r=-1;++r<t;)o[r]=e[r];return o[t]=a,u(n,this,o)}}function so(n,t){if("function"!=typeof n)throw new Fl(wn);return t=t===Q?0:pc(uu(t),0),co(function(e){var r=e[t],i=e.slice(0,t);return r&&v(i,r),u(n,this,i)})}function fo(n,t,e){var r=!0,i=!0;if("function"!=typeof n)throw new Fl(wn);return $o(e)&&(r="leading"in e?!!e.leading:r,i="trailing"in e?!!e.trailing:i),io(n,t,{leading:r,maxWait:t,trailing:i})}function ho(n){return no(n,1)}function po(n,t){return t=null==t?pl:t,_s(t,n)}function go(){if(!arguments.length)return[];var n=arguments[0];return ws(n)?n:[n]}function mo(n){return je(n)}function vo(n,t){return je(n,!1,t)}function _o(n){return je(n,!0)}function yo(n,t){return je(n,!0,t)}function bo(n,t){return n===t||n!==n&&t!==t}function wo(n,t){return n>t}function xo(n,t){return n>=t}function ko(n){return Oo(n)&&Ul.call(n,"callee")&&(!oc.call(n,"callee")||Vl.call(n)==In)}function jo(n){return zo(n)&&Vl.call(n)==Vn}function Co(n){return null!=n&&!("function"==typeof n&&Po(n))&&No($c(n))}function Oo(n){return zo(n)&&Co(n)}function Ao(n){return n===!0||n===!1||zo(n)&&Vl.call(n)==Tn}function Eo(n){return zo(n)&&Vl.call(n)==Ln}function So(n){return!!n&&1===n.nodeType&&zo(n)&&!Go(n)}function Ro(n){if(Co(n)&&(ws(n)||Qo(n)||Po(n.splice)||ko(n)))return!n.length;for(var t in n)if(Ul.call(n,t))return!1;return!0}function Io(n,t){return Je(n,t)}function Mo(n,t,e){e="function"==typeof e?e:Q;var r=e?e(n,t):Q;return r===Q?Je(n,t,e):!!r}function To(n){return zo(n)?Vl.call(n)==Pn||"string"==typeof n.message&&"string"==typeof n.name:!1}function Lo(n){return"number"==typeof n&&fc(n)}function Po(n){var t=$o(n)?Vl.call(n):"";return t==Dn||t==Nn}function Do(n){return"number"==typeof n&&n==uu(n)}function No(n){return"number"==typeof n&&n>-1&&n%1==0&&jn>=n}function $o(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function zo(n){return!!n&&"object"==typeof n}function Fo(n){return zo(n)&&gi(n)==$n}function qo(n,t){return n===t||Ze(n,t,di(t))}function Bo(n,t,e){return e="function"==typeof e?e:Q,Ze(n,t,di(t),e)}function Ko(n){return Vo(n)&&n!=+n}function Uo(n){return null==n?!1:Po(n)?Jl.test(Kl.call(n)):zo(n)&&(B(n)?Jl:At).test(n)}function Wo(n){return null===n}function Ho(n){return null==n}function Vo(n){return"number"==typeof n||zo(n)&&Vl.call(n)==zn}function Go(n){if(!zo(n)||Vl.call(n)!=Fn||B(n))return!1;var t=ec(n);if(null===t)return!0;var e=t.constructor;return"function"==typeof e&&e instanceof e&&Kl.call(e)==Hl}function Jo(n){return $o(n)&&Vl.call(n)==qn}function Yo(n){return Do(n)&&n>=-jn&&jn>=n}function Zo(n){return zo(n)&&gi(n)==Bn}function Qo(n){return"string"==typeof n||!ws(n)&&zo(n)&&Vl.call(n)==Kn}function Xo(n){return"symbol"==typeof n||zo(n)&&Vl.call(n)==Un}function nu(n){return zo(n)&&No(n.length)&&!!we[Vl.call(n)]}function tu(n){return n===Q}function eu(n){return zo(n)&&gi(n)==Wn}function ru(n){return zo(n)&&Vl.call(n)==Hn}function iu(n,t){return t>n}function au(n,t){return t>=n}function ou(n){if(!n)return[];if(Co(n))return Qo(n)?J(n):$r(n);if(ic&&n[ic])return U(n[ic]());var t=gi(n),e=t==$n?W:t==Bn?V:$u;return e(n)}function uu(n){if(!n)return 0===n?n:0;if(n=cu(n),n===kn||n===-kn){var t=0>n?-1:1;return t*Cn}var e=n%1;return n===n?e?n-e:n:0}function lu(n){return n?ke(uu(n),0,An):0}function cu(n){if($o(n)){var t=Po(n.valueOf)?n.valueOf():n;n=$o(t)?t+"":t}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(_t,"");var e=Ot.test(n);return e||Et.test(n)?Se(n.slice(2),e?2:8):Ct.test(n)?On:+n}function su(n){return zr(n,Ou(n))}function fu(n){return ke(uu(n),-jn,jn)}function du(n){if("string"==typeof n)return n;if(null==n)return"";if(Xo(n))return Ql?Sc.call(n):"";var t=n+"";return"0"==t&&1/n==-kn?"-0":t}function hu(n,t){var e=Oe(n);return t?ce(e,t):e}function pu(n,t){return x(n,fi(t,3),ze,!0)}function gu(n,t){return x(n,fi(t,3),Fe,!0)}function mu(n,t){return null==n?n:Tc(n,de(t),Ou)}function vu(n,t){return null==n?n:Lc(n,de(t),Ou)}function _u(n,t){return n&&ze(n,de(t))}function yu(n,t){return n&&Fe(n,de(t))}function bu(n){return null==n?[]:qe(n,Cu(n))}function wu(n){return null==n?[]:qe(n,Ou(n))}function xu(n,t,e){var r=null==n?Q:Be(n,t);return r===Q?e:r}function ku(n,t){return vi(n,t,Ke)}function ju(n,t){return vi(n,t,Ue)}function Cu(n){var t=Oi(n);if(!t&&!Co(n))return Xe(n);var e=wi(n),r=!!e,i=e||[],a=i.length;for(var o in n)!Ke(n,o)||r&&("length"==o||K(o,a))||t&&"constructor"==o||i.push(o);return i}function Ou(n){for(var t=-1,e=Oi(n),r=nr(n),i=r.length,a=wi(n),o=!!a,u=a||[],l=u.length;++t<i;){var c=r[t];o&&("length"==c||K(c,l))||"constructor"==c&&(e||!Ul.call(n,c))||u.push(c)}return u}function Au(n,t){var e={};return t=fi(t,3),ze(n,function(n,r,i){e[t(n,r,i)]=n}),e}function Eu(n,t){var e={};return t=fi(t,3),ze(n,function(n,r,i){e[r]=t(n,r,i)}),e}function Su(n,t){return t=fi(t),lr(n,function(n,e){return!t(n,e)})}function Ru(n,t){return null==n?{}:lr(n,fi(t))}function Iu(n,t,e){if(ki(t,n))r=null==n?Q:n[t];else{t=pe(t);var r=xu(n,t);n=Ri(n,t)}return r===Q&&(r=e),Po(r)?r.call(n):r}function Mu(n,t,e){return null==n?n:mr(n,t,e)}function Tu(n,t,e,r){return r="function"==typeof r?r:Q,null==n?n:mr(n,t,e,r)}function Lu(n){return S(n,Cu(n))}function Pu(n){return S(n,Ou(n))}function Du(n,t,e){var r=ws(n)||nu(n);if(t=fi(t,4),null==e)if(r||$o(n)){var i=n.constructor;e=r?ws(n)?new i:[]:Po(i)?Oe(ec(n)):{}}else e={};return(r?s:ze)(n,function(n,r,i){return t(e,n,r,i)}),e}function Nu(n,t){return null==n?!0:jr(n,t)}function $u(n){return n?I(n,Cu(n)):[]}function zu(n){return null==n?[]:I(n,Ou(n))}function Fu(n,t,e){return e===Q&&(e=t,t=Q),e!==Q&&(e=cu(e),e=e===e?e:0),t!==Q&&(t=cu(t),t=t===t?t:0),ke(cu(n),t,e)}function qu(n,t,e){return t=cu(t)||0,e===Q?(e=t,t=0):e=cu(e)||0,n=cu(n),We(n,t,e)}function Bu(n,t,e){if(e&&"boolean"!=typeof e&&xi(n,t,e)&&(t=e=Q),e===Q&&("boolean"==typeof t?(e=t,t=Q):"boolean"==typeof n&&(e=n,n=Q)),n===Q&&t===Q?(n=0,t=1):(n=cu(n)||0,t===Q?(t=n,n=0):t=cu(t)||0),n>t){var r=n;n=t,t=r}if(e||n%1||t%1){var i=vc();return gc(n+i*(t-n+Ee("1e-"+((i+"").length-1))),t)}return pr(n,t)}function Ku(n){return qs(du(n).toLowerCase())}function Uu(n){return n=du(n),n&&n.replace(Rt,$).replace(he,"")}function Wu(n,t,e){n=du(n),t="string"==typeof t?t:t+"";var r=n.length;return e=e===Q?r:ke(uu(e),0,r),e-=t.length,e>=0&&n.indexOf(t,e)==e}function Hu(n){return n=du(n),n&&ct.test(n)?n.replace(ut,z):n}function Vu(n){return n=du(n),n&&vt.test(n)?n.replace(mt,"\\$&"):n}function Gu(n,t,e){n=du(n),t=uu(t);var r=G(n);if(!t||r>=t)return n;var i=(t-r)/2,a=sc(i),o=cc(i);return ti("",a,e)+n+ti("",o,e)}function Ju(n,t,e){return n=du(n),n+ti(n,t,e)}function Yu(n,t,e){return n=du(n),ti(n,t,e)+n}function Zu(n,t,e){return e||null==t?t=0:t&&(t=+t),n=du(n).replace(_t,""),mc(n,t||(jt.test(n)?16:10))}function Qu(n,t){n=du(n),t=uu(t);var e="";if(!n||1>t||t>jn)return e;do t%2&&(e+=n),t=sc(t/2),n+=n;while(t);return e}function Xu(){var n=arguments,t=du(n[0]);return n.length<3?t:t.replace(n[1],n[2])}function nl(n,t,e){return du(n).split(t,e)}function tl(n,t,e){return n=du(n),e=ke(uu(e),0,n.length),n.lastIndexOf(t,e)==e}function el(n,e,r){var i=t.templateSettings;r&&xi(n,e,r)&&(e=Q),n=du(n),e=Cs({},e,i,ae);var a,o,u=Cs({},e.imports,i.imports,ae),l=Cu(u),c=I(u,l),s=0,f=e.interpolate||It,d="__p += '",h=zl((e.escape||It).source+"|"+f.source+"|"+(f===dt?xt:It).source+"|"+(e.evaluate||It).source+"|$","g"),p="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++be+"]")+"\n";n.replace(h,function(t,e,r,i,u,l){return r||(r=i),d+=n.slice(s,l).replace(Mt,F),e&&(a=!0,d+="' +\n__e("+e+") +\n'"),u&&(o=!0,d+="';\n"+u+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),s=l+t.length,t}),d+="';\n";var g=e.variable;g||(d="with (obj) {\n"+d+"\n}\n"),d=(o?d.replace(rt,""):d).replace(it,"$1").replace(at,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Ws(function(){return Function(l,p+"return "+d).apply(Q,c)});if(m.source=d,To(m))throw m;return m}function rl(n){return du(n).toLowerCase()}function il(n){return du(n).toUpperCase()}function al(n,t,e){if(n=du(n),!n)return n;if(e||t===Q)return n.replace(_t,"");if(t+="",!t)return n;var r=J(n),i=J(t);return r.slice(M(r,i),T(r,i)+1).join("")}function ol(n,t,e){if(n=du(n),!n)return n;if(e||t===Q)return n.replace(bt,"");if(t+="",!t)return n;var r=J(n);return r.slice(0,T(r,J(t))+1).join("")}function ul(n,t,e){if(n=du(n),!n)return n;if(e||t===Q)return n.replace(yt,"");if(t+="",!t)return n;var r=J(n);return r.slice(M(r,J(t))).join("")}function ll(n,t){var e=hn,r=pn;if($o(t)){var i="separator"in t?t.separator:i;e="length"in t?uu(t.length):e,r="omission"in t?du(t.omission):r}n=du(n);var a=n.length;if(ge.test(n)){
var o=J(n);a=o.length}if(e>=a)return n;var u=e-G(r);if(1>u)return r;var l=o?o.slice(0,u).join(""):n.slice(0,u);if(i===Q)return l+r;if(o&&(u+=l.length-u),Jo(i)){if(n.slice(u).search(i)){var c,s=l;for(i.global||(i=zl(i.source,du(kt.exec(i))+"g")),i.lastIndex=0;c=i.exec(s);)var f=c.index;l=l.slice(0,f===Q?u:f)}}else if(n.indexOf(i,u)!=u){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+r}function cl(n){return n=du(n),n&&lt.test(n)?n.replace(ot,Y):n}function sl(n,t,e){return n=du(n),t=e?Q:t,t===Q&&(t=_e.test(n)?ve:me),n.match(t)||[]}function fl(n){var t=n?n.length:0,e=fi();return n=t?m(n,function(n){if("function"!=typeof n[1])throw new Fl(wn);return[e(n[0]),n[1]]}):[],co(function(e){for(var r=-1;++r<t;){var i=n[r];if(u(i[0],this,e))return u(i[1],this,e)}})}function dl(n){return Ce(je(n,!0))}function hl(n){return function(){return n}}function pl(n){return n}function gl(n){return Qe("function"==typeof n?n:je(n,!0))}function ml(n){return er(je(n,!0))}function vl(n,t){return rr(n,je(t,!0))}function _l(n,t,e){var r=Cu(t),i=qe(t,r);null!=e||$o(t)&&(i.length||!r.length)||(e=t,t=n,n=this,i=qe(t,Cu(t)));var a=$o(e)&&"chain"in e?e.chain:!0,o=Po(n);return s(i,function(e){var r=t[e];n[e]=r,o&&(n.prototype[e]=function(){var t=this.__chain__;if(a||t){var e=n(this.__wrapped__),i=e.__actions__=$r(this.__actions__);return i.push({func:r,args:arguments,thisArg:n}),e.__chain__=t,e}return r.apply(n,v([this.value()],arguments))})}),n}function yl(){return Ne._===this&&(Ne._=Gl),this}function bl(){}function wl(n){return n=uu(n),function(){return arguments[n]}}function xl(n){return ki(n)?cr(n):sr(n)}function kl(n){return function(t){return null==n?Q:Be(n,t)}}function jl(n,t){if(n=uu(n),1>n||n>jn)return[];var e=An,r=gc(n,An);t=de(t),n-=An;for(var i=E(r,t);++e<n;)t(e);return i}function Cl(n){return ws(n)?m(n,String):Mi(n)}function Ol(n){var t=++Wl;return du(n)+t}function Al(n,t){var e;return n===Q&&t===Q?0:(n!==Q&&(e=n),t!==Q&&(e=e===Q?t:e+t),e)}function El(n){return n&&n.length?w(n,pl,wo):Q}function Sl(n,t){return n&&n.length?w(n,fi(t),wo):Q}function Rl(n){return Ll(n)/(n?n.length:0)}function Il(n){return n&&n.length?w(n,pl,iu):Q}function Ml(n,t){return n&&n.length?w(n,fi(t),iu):Q}function Tl(n,t){var e;return n===Q&&t===Q?0:(n!==Q&&(e=n),t!==Q&&(e=e===Q?t:e-t),e)}function Ll(n){return n&&n.length?A(n,pl):0}function Pl(n,t){return n&&n.length?A(n,fi(t)):0}n=n?$e.defaults({},n,$e.pick(Ne,ye)):Ne;var Dl=n.Date,Nl=n.Error,$l=n.Math,zl=n.RegExp,Fl=n.TypeError,ql=n.Array.prototype,Bl=n.Object.prototype,Kl=n.Function.prototype.toString,Ul=Bl.hasOwnProperty,Wl=0,Hl=Kl.call(Object),Vl=Bl.toString,Gl=Ne._,Jl=zl("^"+Kl.call(Ul).replace(mt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yl=Me?n.Buffer:Q,Zl=n.Reflect,Ql=n.Symbol,Xl=n.Uint8Array,nc=n.clearTimeout,tc=Zl?Zl.enumerate:Q,ec=Object.getPrototypeOf,rc=Object.getOwnPropertySymbols,ic="symbol"==typeof(ic=Ql&&Ql.iterator)?ic:Q,ac=Object.create,oc=Bl.propertyIsEnumerable,uc=n.setTimeout,lc=ql.splice,cc=$l.ceil,sc=$l.floor,fc=n.isFinite,dc=ql.join,hc=Object.keys,pc=$l.max,gc=$l.min,mc=n.parseInt,vc=$l.random,_c=ql.reverse,yc=hi(n,"Map"),bc=hi(n,"Set"),wc=hi(n,"WeakMap"),xc=hi(Object,"create"),kc=wc&&new wc,jc=yc?Kl.call(yc):"",Cc=bc?Kl.call(bc):"",Oc=wc?Kl.call(wc):"",Ac=Ql?Ql.prototype:Q,Ec=Ql?Ac.valueOf:Q,Sc=Ql?Ac.toString:Q,Rc={};t.templateSettings={escape:st,evaluate:ft,interpolate:dt,variable:"",imports:{_:t}};var Ic=Ur(ze),Mc=Ur(Fe,!0),Tc=Wr(),Lc=Wr(!0);tc&&!oc.call({valueOf:1},"valueOf")&&(nr=function(n){return U(tc(n))});var Pc=kc?function(n,t){return kc.set(n,t),n}:pl,Dc=bc&&2===new bc([1,2]).size?function(n){return new bc(n)}:bl,Nc=kc?function(n){return kc.get(n)}:bl,$c=cr("length"),zc=rc||function(){return[]};(yc&&gi(new yc)!=$n||bc&&gi(new bc)!=Bn||wc&&gi(new wc)!=Wn)&&(gi=function(n){var t=Vl.call(n),e=t==Fn?n.constructor:null,r="function"==typeof e?Kl.call(e):"";if(r)switch(r){case jc:return $n;case Cc:return Bn;case Oc:return Wn}return t});var Fc=function(){var n=0,t=0;return function(e,r){var i=ds(),a=mn-(i-t);if(t=i,a>0){if(++n>=gn)return e}else n=0;return Pc(e,r)}}(),qc=co(function(n,t){return ws(n)||(n=null==n?[]:[Object(n)]),t=Pe(t,1),c(n,t)}),Bc=co(function(n,t){return Oo(n)?Re(n,Pe(t,1,!0)):[]}),Kc=co(function(n,t){var e=Zi(t);return Oo(e)&&(e=Q),Oo(n)?Re(n,Pe(t,1,!0),fi(e)):[]}),Uc=co(function(n,t){var e=Zi(t);return Oo(e)&&(e=Q),Oo(n)?Re(n,Pe(t,1,!0),Q,e):[]}),Wc=co(function(n){var t=m(n,fe);return t.length&&t[0]===n[0]?He(t):[]}),Hc=co(function(n){var t=Zi(n),e=m(n,fe);return t===Zi(e)?t=Q:e.pop(),e.length&&e[0]===n[0]?He(e,fi(t)):[]}),Vc=co(function(n){var t=Zi(n),e=m(n,fe);return t===Zi(e)?t=Q:e.pop(),e.length&&e[0]===n[0]?He(e,Q,t):[]}),Gc=co(Xi),Jc=co(function(n,t){t=m(Pe(t,1),String);var e=se(n,t);return hr(n,t.sort(P)),e}),Yc=co(function(n){return kr(Pe(n,1,!0))}),Zc=co(function(n){var t=Zi(n);return Oo(t)&&(t=Q),kr(Pe(n,1,!0),fi(t))}),Qc=co(function(n){var t=Zi(n);return Oo(t)&&(t=Q),kr(Pe(n,1,!0),Q,t)}),Xc=co(function(n,t){return Oo(n)?Re(n,t):[]}),ns=co(function(n){return Ar(h(n,Oo))}),ts=co(function(n){var t=Zi(n);return Oo(t)&&(t=Q),Ar(h(n,Oo),fi(t))}),es=co(function(n){var t=Zi(n);return Oo(t)&&(t=Q),Ar(h(n,Oo),Q,t)}),rs=co(ba),is=co(function(n){var t=n.length,e=t>1?n[t-1]:Q;return e="function"==typeof e?(n.pop(),e):Q,wa(n,e)}),as=co(function(n){n=Pe(n,1);var t=n.length,e=t?n[0]:0,a=this.__wrapped__,o=function(t){return se(t,n)};return!(t>1||this.__actions__.length)&&a instanceof i&&K(e)?(a=a.slice(e,+e+(t?1:0)),a.__actions__.push({func:Oa,args:[o],thisArg:Q}),new r(a,this.__chain__).thru(function(n){return t&&!n.length&&n.push(Q),n})):this.thru(o)}),os=Br(function(n,t,e){Ul.call(n,e)?++n[e]:n[e]=1}),us=Br(function(n,t,e){Ul.call(n,e)?n[e].push(t):n[e]=[t]}),ls=co(function(n,t,e){var r=-1,i="function"==typeof t,a=ki(t),o=Co(n)?Array(n.length):[];return Ic(n,function(n){var l=i?t:a&&null!=n?n[t]:Q;o[++r]=l?u(l,n,e):Ge(n,t,e)}),o}),cs=Br(function(n,t,e){n[e]=t}),ss=Br(function(n,t,e){n[e?0:1].push(t)},function(){return[[],[]]}),fs=co(function(n,t){if(null==n)return[];var e=t.length;return e>1&&xi(n,t[0],t[1])?t=[]:e>2&&xi(t[0],t[1],t[2])&&(t.length=1),or(n,Pe(t,1),[])}),ds=Dl.now,hs=co(function(n,t,e){var r=nn;if(e.length){var i=H(e,pi(hs));r|=on}return oi(n,r,t,e,i)}),ps=co(function(n,t,e){var r=nn|tn;if(e.length){var i=H(e,pi(ps));r|=on}return oi(t,r,n,e,i)}),gs=co(function(n,t){return Ae(n,1,t)}),ms=co(function(n,t,e){return Ae(n,cu(t)||0,e)}),vs=co(function(n,t){t=m(Pe(t,1),fi());var e=t.length;return co(function(r){for(var i=-1,a=gc(r.length,e);++i<a;)r[i]=t[i].call(this,r[i]);return u(n,this,r)})}),_s=co(function(n,t){var e=H(t,pi(_s));return oi(n,on,Q,t,e)}),ys=co(function(n,t){var e=H(t,pi(ys));return oi(n,un,Q,t,e)}),bs=co(function(n,t){return oi(n,cn,Q,Q,Q,Pe(t,1))}),ws=Array.isArray,xs=Yl?function(n){return n instanceof Yl}:hl(!1),ks=Kr(function(n,t){zr(t,Cu(t),n)}),js=Kr(function(n,t){zr(t,Ou(t),n)}),Cs=Kr(function(n,t,e,r){Fr(t,Ou(t),n,r)}),Os=Kr(function(n,t,e,r){Fr(t,Cu(t),n,r)}),As=co(function(n,t){return se(n,Pe(t,1))}),Es=co(function(n){return n.push(Q,ae),u(Cs,Q,n)}),Ss=co(function(n){return n.push(Q,Si),u(Ls,Q,n)}),Rs=Xr(function(n,t,e){n[t]=e},hl(pl)),Is=Xr(function(n,t,e){Ul.call(n,t)?n[t].push(e):n[t]=[e]},fi),Ms=co(Ge),Ts=Kr(function(n,t,e){ir(n,t,e)}),Ls=Kr(function(n,t,e,r){ir(n,t,e,r)}),Ps=co(function(n,t){return null==n?{}:(t=m(Pe(t,1),String),ur(n,Re(Ou(n),t)))}),Ds=co(function(n,t){return null==n?{}:ur(n,Pe(t,1))}),Ns=Gr(function(n,t,e){return t=t.toLowerCase(),n+(e?Ku(t):t)}),$s=Gr(function(n,t,e){return n+(e?"-":"")+t.toLowerCase()}),zs=Gr(function(n,t,e){return n+(e?" ":"")+t.toLowerCase()}),Fs=Vr("toLowerCase"),qs=Vr("toUpperCase"),Bs=Gr(function(n,t,e){return n+(e?"_":"")+t.toLowerCase()}),Ks=Gr(function(n,t,e){return n+(e?" ":"")+Ku(t)}),Us=Gr(function(n,t,e){return n+(e?" ":"")+t.toUpperCase()}),Ws=co(function(n,t){try{return u(n,Q,t)}catch(e){return To(e)?e:new Nl(e)}}),Hs=co(function(n,t){return s(Pe(t,1),function(t){n[t]=hs(n[t],n)}),n}),Vs=Zr(),Gs=Zr(!0),Js=co(function(n,t){return function(e){return Ge(e,n,t)}}),Ys=co(function(n,t){return function(e){return Ge(n,e,t)}}),Zs=ni(m),Qs=ni(d),Xs=ni(b),nf=ri(),tf=ri(!0),ef=ai("ceil"),rf=ai("floor"),af=ai("round");return t.prototype=e.prototype,r.prototype=Oe(e.prototype),r.prototype.constructor=r,i.prototype=Oe(e.prototype),i.prototype.constructor=i,Lt.prototype=xc?xc(null):Bl,zt.prototype.clear=Ft,zt.prototype["delete"]=qt,zt.prototype.get=Bt,zt.prototype.has=Kt,zt.prototype.set=Ut,Wt.prototype.push=Vt,Gt.prototype.clear=Jt,Gt.prototype["delete"]=Yt,Gt.prototype.get=Zt,Gt.prototype.has=Qt,Gt.prototype.set=Xt,oo.Cache=zt,t.after=Xa,t.ary=no,t.assign=ks,t.assignIn=js,t.assignInWith=Cs,t.assignWith=Os,t.at=As,t.before=to,t.bind=hs,t.bindAll=Hs,t.bindKey=ps,t.castArray=go,t.chain=ja,t.chunk=Li,t.compact=Pi,t.concat=qc,t.cond=fl,t.conforms=dl,t.constant=hl,t.countBy=os,t.create=hu,t.curry=eo,t.curryRight=ro,t.debounce=io,t.defaults=Es,t.defaultsDeep=Ss,t.defer=gs,t.delay=ms,t.difference=Bc,t.differenceBy=Kc,t.differenceWith=Uc,t.drop=Di,t.dropRight=Ni,t.dropRightWhile=$i,t.dropWhile=zi,t.fill=Fi,t.filter=Da,t.flatMap=za,t.flatten=Ki,t.flattenDeep=Ui,t.flattenDepth=Wi,t.flip=ao,t.flow=Vs,t.flowRight=Gs,t.fromPairs=Hi,t.functions=bu,t.functionsIn=wu,t.groupBy=us,t.initial=Ji,t.intersection=Wc,t.intersectionBy=Hc,t.intersectionWith=Vc,t.invert=Rs,t.invertBy=Is,t.invokeMap=ls,t.iteratee=gl,t.keyBy=cs,t.keys=Cu,t.keysIn=Ou,t.map=Ka,t.mapKeys=Au,t.mapValues=Eu,t.matches=ml,t.matchesProperty=vl,t.memoize=oo,t.merge=Ts,t.mergeWith=Ls,t.method=Js,t.methodOf=Ys,t.mixin=_l,t.negate=uo,t.nthArg=wl,t.omit=Ps,t.omitBy=Su,t.once=lo,t.orderBy=Ua,t.over=Zs,t.overArgs=vs,t.overEvery=Qs,t.overSome=Xs,t.partial=_s,t.partialRight=ys,t.partition=ss,t.pick=Ds,t.pickBy=Ru,t.property=xl,t.propertyOf=kl,t.pull=Gc,t.pullAll=Xi,t.pullAllBy=na,t.pullAt=Jc,t.range=nf,t.rangeRight=tf,t.rearg=bs,t.reject=Va,t.remove=ta,t.rest=co,t.reverse=ea,t.sampleSize=Ja,t.set=Mu,t.setWith=Tu,t.shuffle=Ya,t.slice=ra,t.sortBy=fs,t.sortedUniq=sa,t.sortedUniqBy=fa,t.split=nl,t.spread=so,t.tail=da,t.take=ha,t.takeRight=pa,t.takeRightWhile=ga,t.takeWhile=ma,t.tap=Ca,t.throttle=fo,t.thru=Oa,t.toArray=ou,t.toPairs=Lu,t.toPairsIn=Pu,t.toPath=Cl,t.toPlainObject=su,t.transform=Du,t.unary=ho,t.union=Yc,t.unionBy=Zc,t.unionWith=Qc,t.uniq=va,t.uniqBy=_a,t.uniqWith=ya,t.unset=Nu,t.unzip=ba,t.unzipWith=wa,t.values=$u,t.valuesIn=zu,t.without=Xc,t.words=sl,t.wrap=po,t.xor=ns,t.xorBy=ts,t.xorWith=es,t.zip=rs,t.zipObject=xa,t.zipObjectDeep=ka,t.zipWith=is,t.extend=js,t.extendWith=Cs,_l(t,t),t.add=Al,t.attempt=Ws,t.camelCase=Ns,t.capitalize=Ku,t.ceil=ef,t.clamp=Fu,t.clone=mo,t.cloneDeep=_o,t.cloneDeepWith=yo,t.cloneWith=vo,t.deburr=Uu,t.endsWith=Wu,t.eq=bo,t.escape=Hu,t.escapeRegExp=Vu,t.every=Pa,t.find=Na,t.findIndex=qi,t.findKey=pu,t.findLast=$a,t.findLastIndex=Bi,t.findLastKey=gu,t.floor=rf,t.forEach=Fa,t.forEachRight=qa,t.forIn=mu,t.forInRight=vu,t.forOwn=_u,t.forOwnRight=yu,t.get=xu,t.gt=wo,t.gte=xo,t.has=ku,t.hasIn=ju,t.head=Vi,t.identity=pl,t.includes=Ba,t.indexOf=Gi,t.inRange=qu,t.invoke=Ms,t.isArguments=ko,t.isArray=ws,t.isArrayBuffer=jo,t.isArrayLike=Co,t.isArrayLikeObject=Oo,t.isBoolean=Ao,t.isBuffer=xs,t.isDate=Eo,t.isElement=So,t.isEmpty=Ro,t.isEqual=Io,t.isEqualWith=Mo,t.isError=To,t.isFinite=Lo,t.isFunction=Po,t.isInteger=Do,t.isLength=No,t.isMap=Fo,t.isMatch=qo,t.isMatchWith=Bo,t.isNaN=Ko,t.isNative=Uo,t.isNil=Ho,t.isNull=Wo,t.isNumber=Vo,t.isObject=$o,t.isObjectLike=zo,t.isPlainObject=Go,t.isRegExp=Jo,t.isSafeInteger=Yo,t.isSet=Zo,t.isString=Qo,t.isSymbol=Xo,t.isTypedArray=nu,t.isUndefined=tu,t.isWeakMap=eu,t.isWeakSet=ru,t.join=Yi,t.kebabCase=$s,t.last=Zi,t.lastIndexOf=Qi,t.lowerCase=zs,t.lowerFirst=Fs,t.lt=iu,t.lte=au,t.max=El,t.maxBy=Sl,t.mean=Rl,t.min=Il,t.minBy=Ml,t.noConflict=yl,t.noop=bl,t.now=ds,t.pad=Gu,t.padEnd=Ju,t.padStart=Yu,t.parseInt=Zu,t.random=Bu,t.reduce=Wa,t.reduceRight=Ha,t.repeat=Qu,t.replace=Xu,t.result=Iu,t.round=af,t.runInContext=Z,t.sample=Ga,t.size=Za,t.snakeCase=Bs,t.some=Qa,t.sortedIndex=ia,t.sortedIndexBy=aa,t.sortedIndexOf=oa,t.sortedLastIndex=ua,t.sortedLastIndexBy=la,t.sortedLastIndexOf=ca,t.startCase=Ks,t.startsWith=tl,t.subtract=Tl,t.sum=Ll,t.sumBy=Pl,t.template=el,t.times=jl,t.toInteger=uu,t.toLength=lu,t.toLower=rl,t.toNumber=cu,t.toSafeInteger=fu,t.toString=du,t.toUpper=il,t.trim=al,t.trimEnd=ol,t.trimStart=ul,t.truncate=ll,t.unescape=cl,t.uniqueId=Ol,t.upperCase=Us,t.upperFirst=qs,t.each=Fa,t.eachRight=qa,t.first=Vi,_l(t,function(){var n={};return ze(t,function(e,r){Ul.call(t.prototype,r)||(n[r]=e)}),n}(),{chain:!1}),t.VERSION=X,s(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){t[n].placeholder=t}),s(["drop","take"],function(n,t){i.prototype[n]=function(e){var r=this.__filtered__;if(r&&!t)return new i(this);e=e===Q?1:pc(uu(e),0);var a=this.clone();return r?a.__takeCount__=gc(e,a.__takeCount__):a.__views__.push({size:gc(e,An),type:n+(a.__dir__<0?"Right":"")}),a},i.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),s(["filter","map","takeWhile"],function(n,t){var e=t+1,r=e==_n||e==bn;i.prototype[n]=function(n){var t=this.clone();return t.__iteratees__.push({iteratee:fi(n,3),type:e}),t.__filtered__=t.__filtered__||r,t}}),s(["head","last"],function(n,t){var e="take"+(t?"Right":"");i.prototype[n]=function(){return this[e](1).value()[0]}}),s(["initial","tail"],function(n,t){var e="drop"+(t?"":"Right");i.prototype[n]=function(){return this.__filtered__?new i(this):this[e](1)}}),i.prototype.compact=function(){return this.filter(pl)},i.prototype.find=function(n){return this.filter(n).head()},i.prototype.findLast=function(n){return this.reverse().find(n)},i.prototype.invokeMap=co(function(n,t){return"function"==typeof n?new i(this):this.map(function(e){return Ge(e,n,t)})}),i.prototype.reject=function(n){return n=fi(n,3),this.filter(function(t){return!n(t)})},i.prototype.slice=function(n,t){n=uu(n);var e=this;return e.__filtered__&&(n>0||0>t)?new i(e):(0>n?e=e.takeRight(-n):n&&(e=e.drop(n)),t!==Q&&(t=uu(t),e=0>t?e.dropRight(-t):e.take(t-n)),e)},i.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},i.prototype.toArray=function(){return this.take(An)},ze(i.prototype,function(n,e){var a=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),u=t[o?"take"+("last"==e?"Right":""):e],l=o||/^find/.test(e);u&&(t.prototype[e]=function(){var e=this.__wrapped__,c=o?[1]:arguments,s=e instanceof i,f=c[0],d=s||ws(e),h=function(n){var e=u.apply(t,v([n],c));return o&&p?e[0]:e};d&&a&&"function"==typeof f&&1!=f.length&&(s=d=!1);var p=this.__chain__,g=!!this.__actions__.length,m=l&&!p,_=s&&!g;if(!l&&d){e=_?e:new i(this);var y=n.apply(e,c);return y.__actions__.push({func:Oa,args:[h],thisArg:Q}),new r(y,p)}return m&&_?n.apply(this,c):(y=this.thru(h),m?o?y.value()[0]:y.value():y)})}),s(["pop","push","shift","sort","splice","unshift"],function(n){var e=ql[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",i=/^(?:pop|shift)$/.test(n);t.prototype[n]=function(){var n=arguments;return i&&!this.__chain__?e.apply(this.value(),n):this[r](function(t){return e.apply(t,n)})}}),ze(i.prototype,function(n,e){var r=t[e];if(r){var i=r.name+"",a=Rc[i]||(Rc[i]=[]);a.push({name:e,func:r})}}),Rc[Qr(Q,tn).name]=[{name:"wrapper",func:Q}],i.prototype.clone=L,i.prototype.reverse=St,i.prototype.value=Tt,t.prototype.at=as,t.prototype.chain=Aa,t.prototype.commit=Ea,t.prototype.flatMap=Sa,t.prototype.next=Ra,t.prototype.plant=Ma,t.prototype.reverse=Ta,t.prototype.toJSON=t.prototype.valueOf=t.prototype.value=La,ic&&(t.prototype[ic]=Ia),t}var Q,X="4.5.1",nn=1,tn=2,en=4,rn=8,an=16,on=32,un=64,ln=128,cn=256,sn=512,fn=1,dn=2,hn=30,pn="...",gn=150,mn=16,vn=200,_n=1,yn=2,bn=3,wn="Expected a function",xn="__lodash_hash_undefined__",kn=1/0,jn=9007199254740991,Cn=1.7976931348623157e308,On=NaN,An=4294967295,En=An-1,Sn=An>>>1,Rn="__lodash_placeholder__",In="[object Arguments]",Mn="[object Array]",Tn="[object Boolean]",Ln="[object Date]",Pn="[object Error]",Dn="[object Function]",Nn="[object GeneratorFunction]",$n="[object Map]",zn="[object Number]",Fn="[object Object]",qn="[object RegExp]",Bn="[object Set]",Kn="[object String]",Un="[object Symbol]",Wn="[object WeakMap]",Hn="[object WeakSet]",Vn="[object ArrayBuffer]",Gn="[object Float32Array]",Jn="[object Float64Array]",Yn="[object Int8Array]",Zn="[object Int16Array]",Qn="[object Int32Array]",Xn="[object Uint8Array]",nt="[object Uint8ClampedArray]",tt="[object Uint16Array]",et="[object Uint32Array]",rt=/\b__p \+= '';/g,it=/\b(__p \+=) '' \+/g,at=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ot=/&(?:amp|lt|gt|quot|#39|#96);/g,ut=/[&<>"'`]/g,lt=RegExp(ot.source),ct=RegExp(ut.source),st=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,dt=/<%=([\s\S]+?)%>/g,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pt=/^\w*$/,gt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,mt=/[\\^$.*+?()[\]{}|]/g,vt=RegExp(mt.source),_t=/^\s+|\s+$/g,yt=/^\s+/,bt=/\s+$/,wt=/\\(\\)?/g,xt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,kt=/\w*$/,jt=/^0x/i,Ct=/^[-+]0x[0-9a-f]+$/i,Ot=/^0b[01]+$/i,At=/^\[object .+?Constructor\]$/,Et=/^0o[0-7]+$/i,St=/^(?:0|[1-9]\d*)$/,Rt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,It=/($^)/,Mt=/['\n\r\u2028\u2029\\]/g,Tt="\\ud800-\\udfff",Lt="\\u0300-\\u036f\\ufe20-\\ufe23",Pt="\\u20d0-\\u20f0",Dt="\\u2700-\\u27bf",Nt="a-z\\xdf-\\xf6\\xf8-\\xff",$t="\\xac\\xb1\\xd7\\xf7",zt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ft="\\u2018\\u2019\\u201c\\u201d",qt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Bt="A-Z\\xc0-\\xd6\\xd8-\\xde",Kt="\\ufe0e\\ufe0f",Ut=$t+zt+Ft+qt,Wt="["+Tt+"]",Ht="["+Ut+"]",Vt="["+Lt+Pt+"]",Gt="\\d+",Jt="["+Dt+"]",Yt="["+Nt+"]",Zt="[^"+Tt+Ut+Gt+Dt+Nt+Bt+"]",Qt="\\ud83c[\\udffb-\\udfff]",Xt="(?:"+Vt+"|"+Qt+")",ne="[^"+Tt+"]",te="(?:\\ud83c[\\udde6-\\uddff]){2}",ee="[\\ud800-\\udbff][\\udc00-\\udfff]",re="["+Bt+"]",ie="\\u200d",ae="(?:"+Yt+"|"+Zt+")",oe="(?:"+re+"|"+Zt+")",ue=Xt+"?",le="["+Kt+"]?",ce="(?:"+ie+"(?:"+[ne,te,ee].join("|")+")"+le+ue+")*",se=le+ue+ce,fe="(?:"+[Jt,te,ee].join("|")+")"+se,de="(?:"+[ne+Vt+"?",Vt,te,ee,Wt].join("|")+")",he=RegExp(Vt,"g"),pe=RegExp(Qt+"(?="+Qt+")|"+de+se,"g"),ge=RegExp("["+ie+Tt+Lt+Pt+Kt+"]"),me=/[a-zA-Z0-9]+/g,ve=RegExp([re+"?"+Yt+"+(?="+[Ht,re,"$"].join("|")+")",oe+"+(?="+[Ht,re+ae,"$"].join("|")+")",re+"?"+ae+"+",re+"+",Gt,fe].join("|"),"g"),_e=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ye=["Array","Buffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],be=-1,we={};we[Gn]=we[Jn]=we[Yn]=we[Zn]=we[Qn]=we[Xn]=we[nt]=we[tt]=we[et]=!0,we[In]=we[Mn]=we[Vn]=we[Tn]=we[Ln]=we[Pn]=we[Dn]=we[$n]=we[zn]=we[Fn]=we[qn]=we[Bn]=we[Kn]=we[Wn]=!1;var xe={};xe[In]=xe[Mn]=xe[Vn]=xe[Tn]=xe[Ln]=xe[Gn]=xe[Jn]=xe[Yn]=xe[Zn]=xe[Qn]=xe[$n]=xe[zn]=xe[Fn]=xe[qn]=xe[Bn]=xe[Kn]=xe[Un]=xe[Xn]=xe[nt]=xe[tt]=xe[et]=!0,xe[Pn]=xe[Dn]=xe[Wn]=!1;var ke={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},je={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Ce={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Oe={"function":!0,object:!0},Ae={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ee=parseFloat,Se=parseInt,Re=Oe[typeof t]&&t&&!t.nodeType?t:Q,Ie=Oe[typeof n]&&n&&!n.nodeType?n:Q,Me=Ie&&Ie.exports===Re?Re:Q,Te=L(Re&&Ie&&"object"==typeof i&&i),Le=L(Oe[typeof self]&&self),Pe=L(Oe[typeof window]&&window),De=L(Oe[typeof this]&&this),Ne=Te||Pe!==(De&&De.window)&&Pe||Le||De||Function("return this")(),$e=Z();(Pe||Le||{})._=$e,r=function(){return $e}.call(t,e,t,n),!(r!==Q&&(n.exports=r))}).call(this)}).call(t,e(2)(n),function(){return this}())},function(n,t){n.exports="2016/08/27/reading-mithriljs-4.yml\n2016/08/25/reading-mithriljs-3.yml\n2016/08/24/reading-mithriljs-2.yml\n2016/08/22/reading-mithriljs.yml\n2016/07/29/js-test-with-karma-webpack-es6.yml\n2016/05/05/module-global-vs-class-variable.yml\n2016/04/14/rop.yml\n2016/03/21/pipe.yml\n2016/03/19/v8-optimization.yml\n2016/03/13/pyazo.yml\n2016/02/26/expert-python-chapter3.yml\n2016/02/21/mithrilify.yml\n2016/02/14/moved-to-gh-page.yml"},function(n,t,e){function r(n){return e(i(n))}function i(n){return a[n]||function(){throw new Error("Cannot find module '"+n+"'.")}()}var a={"./2016/02/14/moved-to-gh-page.yml":13,"./2016/02/21/mithrilify.yml":14,"./2016/02/26/expert-python-chapter3.yml":15,"./2016/03/13/pyazo.yml":16,"./2016/03/19/v8-optimization.yml":17,"./2016/03/21/pipe.yml":18,"./2016/04/14/rop.yml":19,"./2016/05/05/module-global-vs-class-variable.yml":20,"./2016/07/29/js-test-with-karma-webpack-es6.yml":21,"./2016/08/22/reading-mithriljs.yml":22,"./2016/08/24/reading-mithriljs-2.yml":23,"./2016/08/25/reading-mithriljs-3.yml":24,"./2016/08/27/reading-mithriljs-4.yml":25,"./index.txt":26};r.keys=function(){return Object.keys(a)},r.resolve=i,n.exports=r,r.id=12},function(n,t){n.exports={title:"github pagesに引越し",slug:"moved-to-gh-page",utime:1455438723,date:"2016/02/14 17:32:03",tags:["misc"],publish:!0,body:"jekyllとか色々覚えることが多そうなのでpythonで必要最低限のhtmlのジェネレータを作ってgithub pagesにお引越ししてみました。\n\n記事の情報はyamlで管理して、そいつをパースしてhtmlに吐き出すという感じにしてるのですが、自分しか使わないしかなり雑。\n\n記事の情報管理をyamlでやるのはすごくいいということがわかってきました。\n\nyamlは\n```yaml\ntitle: github pagesに引越し\nslug: moved_to_gh_page\nutime: 1455438723\ndate: 2016/02/14 17:32:03\ntags:\n  - タグ\nactive: true\nbody: |-\n  ほにゃらら\n```\n\nという構成にしていて、こいつをpythonのPyYamlで読み込んだ結果をjinja2で書いたテンプレートにrenderしてやるようにしています。\n\n面倒なのが、リポジトリのトップにあるindex.htmlへ記事の追加を反映しなくてはいけないので都度ビルドコマンドを叩くようにしています。\n\nこの辺はいちいちコマンドを叩かずに変更を監視して自動でビルドするようにしたいなぁと。\n\nまあとにかくブログに特化するというのであればgithub pagesでもイケそうな気がする。"}},function(n,t){n.exports={title:"github pagesの構成を変えた",slug:"mithrilify",utime:1456047517,date:"2016/02/21 18:38:37",tags:["python","javascript","mithril","webpack"],publish:!0,body:"引越しをした時は、pythonで記事データになるyamlファイルをビルドしてhtmlをした後にindex.htmlにリンクを載せるという方法を取っていました。\n\nこのやり方でも問題はないんですが、yamlとhtmlが重複してしまいなんともいけてない感じがしたので、yamlをjsで読み取る方法にしました。\n\nどうせgithubがストレージなんだし記事の目録を作ってやってjsでyamlファイルをパースしてやればええがなという動機です。SPAの利です。\n\njsのフレームワークはなんとなく好きなmithrilを使って組んでいます。ブログみたいな単純なものならちょろっと書けるので最高。\n\nでも結局は、目録を作るというのに変わっただけで記事を新規作成ないし削除をしたら目録を更新しないといけません。circleciとか使ってうまくできないか調べよう。\n\nところで、webpackのloaderは本当に最高で何も考えずにただただ`yaml-loader`を使えば全てが丸く収まるのでもうwebpackから抜け出せなくなりました。\n\nガンガン使っていきましょう。"}},function(n,t){n.exports={title:"pythonの__new__とかtypeなど",slug:"expert-python-chapter3",utime:1456457568,date:"2016/02/26 12:32:48",tags:["python"],publish:!0,body:"pythonコードの読み書き練習のために便利ツールの[percol](https://github.com/mooz/percol)のリファクタリングを始めました。\n\n`percol.finder`という文字列検索処理をしてるっぽいモジュールでメタクラスが使われていたのでメタクラスについてエキパイを読み直しました。\n\nつっても、`percol.finder.Finder`クラスは[ただの抽象基底クラスというだけっぽい。](https://github.com/mooz/percol/blob/master/percol/finder.py#L11-L37)\n\nメタプログラミングなんて高度なことをする場面は中々ないと思うけど、とりあえず`__new__`と`type()`について忘れたくないのでメモ。\n\n```\n$ python -V\nPython 3.5.0\n```\n\n# \\_\\_new\\_\\_\n`__new__`はインスタンスを作成しようとする時に毎回実行される。エキパイ的には`meta-constructor`と説明されている。\n\n```python\nclass C(object):\n  def __new__(cls, *args, **kwargs):\n      print('args: {}'.format(args))\n      print('kargs: {}'.format(kwargs))\n      print('__new__ called.')\n      ins = object.__new__(cls)\n      print('created instance')\n      ins.hoge = 'hoge'\n      return ins\n\n  def __init__(self, arg):\n      print('__init__ called.')\n      self._fuga = arg\n\n  @property\n  def fuga(self):\n      return self._fuga + self.hoge\n\n\nprint(C('fuga').fuga)\n# args: ('fuga',)\n# kargs: {}\n# __new__ called.\n# created instance\n# __init__ called.\n# fugahoge\n```\n\n`__new__`はクラスオブジェクトを引数にとって必ずインスタンスを返さなくてはいけない。つまり、インスタンスを作成する前にクラスオブジェクトを煮るなる焼くなり自由にいじり倒すことができるわけだ。\n\nで、この`C`クラスを継承した場合、子クラスから親クラスの`__init__()`を呼び出すには`super()`をしないといけない。\n\n```pytyhon\nclass C(object):\n    def __new__(cls, *args, **kwargs):\n        print('C.__new__ called.')\n        return object.__new__(cls)\n\n    def __init__(self):\n        print('C.__init__ called.')\n\n\nclass D(C):\n    def __init__(self):\n        print('D.__init__() called')\n\n\nclass E(C):\n    def __init__(self):\n        super().__init__()\n        print('E.__init__() called')\n\n\nprint(D())\n# C.__new__ called.\n# D.__init__() called\n# <__main__.D object at 0x104616f28>\n\nprint(E())\n# C.__new__ called.\n# C.__init__ called.\n# E.__init__() called\n# <__main__.E object at 0x104616f98>\n```\n\nなるほど。\n\n# metaclassとtype\n`metaclass`はクラスのコンストラクタに渡すキーワード引数になる。python2では`__metaclass__`というクラス属性。\n\n`metaclass`は`type()`と同じ形式の引数を取る関数が指定する。\n\n```python\ndef mymetaclass(cls, base, _dict):\n  if '__cat__' in _dict:\n      _dict['__cat__'] = \\\n          'oh! my {}'.format(_dict.get('__cat__', ''))\n  return type(cls, base, _dict)\n\n\nclass A(object, metaclass=mymetaclass):\n    __cat__ = 'neko'\n\n\nprint(a.__cat__)\n# oh! my neko\n```\n\n全く実用的な例ではないけど、クラスの属性を自由に操作できる。というか、`type()`に渡す基底クラスを変えてしまえば自由にクラスオブジェクトを変更できてしまう。\n\nエキパイにも\n\n>For changing the read-write attributes or adding new ones, metaclasses can be avoided for simpler solutions, based on dynamic changes over the class instance.\n\nというふうに書いてあるし、そう気軽に使っていいものではないことがわかる。(というか、使えないだろう。)\n\nで、エキパイのこのチャプタの最後にクラスを拡張するパッチの実装があるのでほぼ丸コピ。\n\n```python\ndef enhancer_1(cls):\n  cls.contracted_name = ''.join(\n      l for l in cls.__name__ if l.isupper()\n  )\n\n\ndef enhancer_2(cls):\n    def logger(func):\n        def wrapper(*args, **kwargs):\n            print('logging!')\n            return func(*args, **kwargs)\n        return wrapper\n    for el in dir(cls):\n        if el.startswith('_'):\n            continue\n        v = getattr(cls, el)\n        if not hasattr(v, '__func__'):\n            continue\n        setattr(cls, el, logger(v))\n\n\ndef enhance(cls, *enhancers):\n    for e in enhancers:\n        e(cls)\n\n\nclass ThisIsMyClass(object):\n    def hi(self):\n        return 'hi'\n\n\nenhance(ThisIsMyClass, enhancer_1, enhancer_2)\nins = ThisIsMyClass()\nassert ins.hi() == 'hi'\nassert ins.__class__.contracted_name == 'TIMC'\n```\n\nなお、メタプログラミングを使うべき時が来、適切に使える時が来るのかガチ不明。"}},function(n,t){n.exports={title:"Gyazo APIのクライアントを雑に作った",slug:"pyazo",utime:1457828361,date:"2016/03/13 09:19:21",tags:["python"],publish:!0,body:"Gyazo APIが非常にシンプルなため本当にシンプルな面白みのない実装になりました。\n\n[pypi](https://pypi.python.org/pypi/pyazo)\n\n[github](https://github.com/mtwtkman/pyazo)\n\npyazoって名前は別言語でかぶってたりしてアレ感ある。\n\nところでこういう外部のAPIのテストってどうしたらいいんじゃろ"}},function(n,t){n.exports={title:"V8で最適化されないjavascript",slug:"v8-optimization",utime:1458391960,date:"2016/03/19 21:52:40",tags:["javascript"],publish:!0,body:"[mithril](https://github.com/lhorie/mithril.js)のコードを読んでいて`for`文で`argumets`の要素をぐるぐる回しながらインデクスアクセスをして配列にデータを詰め込んでる処理が気持ち悪かったので`map`にしてプルリクしたところ、\nパフォーマンスを理由にリジェクトされました。\n\nで、そのプルリクでもらった返答にV8の最適化についてのリンクを併記してもらっていたので読むことにしました。\n\nちなみに[プルリクで修正した内容](https://github.com/lhorie/mithril.js/pull/993/commits/f384054947681d10696fcfeb2fab71f2a40dde1d)はクソ単純で\nArraylikeな`arguments`を`slice`で回すというものです。\n\n[Optimization killersのリンク](https://github.com/petkaantonov/bluebird/wiki/Optimization-killers)\n\n# Unsupported syntax\n2016/3/19現在、V8で最適化できない構文がいくつかある。\n\n- Generator functions\n- Functions that contain a for-of statement\n- Functions that contain a try-catch statement\n- Functions that contain a try-finally statement\n- Functions that contain a compound let assignment\n- Functions that contain a compound const assignment\n- Functions that contain object literals that contain __proto__, or get or set declarations.\n\n`try`文ダメってキツそう。あと`for-of`が最適化されないのもつらい。まあ`for-of`が最適化されるならそっち使うよな。\n\ngeneratorもダメとは…こう見ると単純にES2015以降に対応しきれていないだけという感じか。\n\nあとは↓の場合もダメっぽい\n\n- Functions that contain a debugger statement\n- Functions that call literally eval()\n- Functions that contain a with statement\n\nVBAみたいで悔しい思いをしそうな`with`を使うことはない気がするけど、`eval`や`with`を最適化ができない理由はスコープの判定ができないからとのことらしい。(曖昧)\n\nで、プロダクトコードで例外処理を避けるわけにもいかんということでワークアラウンドなコード例が書いてあったのでそのまま引用。\n\n```javascript\nvar errorObject = {value: null};\nfunction tryCatch(fn, ctx, args) {\n    try {\n        return fn.apply(ctx, args);\n    }\n    catch(e) {\n        errorObject.value = e;\n        return errorObject;\n    }\n}\n\nvar result = tryCatch(mightThrow, void 0, [1,2,3]);\n//Unambiguously tells whether the call threw\nif(result === errorObject) {\n    var error = errorObject.value;\n}\nelse {\n    //result is the returned value\n}\n```\n\nエラーハンドリングは独立した最小限の関数に切り出すのが良いらしい。\nそうすれば最適化されない範囲が最小限になるということだ。\n\n\n# Managing `arguments`\n`arguments`は最適化を阻害する多数の原因になりうるやつだそうだ。\n\n## 1. sloppyモード(=strictモードじゃないやつ)で`arguments`を評価しながら定義済みの引数に再代入する場合\n何言ってんだ？？？？例を見てみよう\n\n```javascript\nfunction defaultArgsReassign(a, b) {\n  if (arguments.length < 2) b = 5;\n}\n```\n\nとにかくこれがダメということらしい。じゃあどうしたらいいのかというと引数の値を新しい変数に保存しましょうとのこと\n\n```javascript\nfunction reAssignParam(a, b_) {\n  var b = b_;\n  //unlike b_, b can safely be reassigned\n  if (arguments.length < 2) b = 5;\n}\n```\n\nただし、今回の場合だとただ引数が与えられているのかをチェックしているだけなので下記のように書くのがいいっぽい。\n\n```javascript\nfunction reAssignParam(a, b) {\n  if (b === void 0) b = 5;\n}\n```\n\nまあでもおとなしく端からstrictモードにしておけば考える必要のない問題ですね。\n\n## 2. `arguments`漏れ\n```javascript\nfunction leaksArguments1() {\n  return arguments;\n}\n\nfunction leaksArguments2() {\n  var args = [].slice.call(arguments);\n}\n\nfunction leaksArguments3() {\n  var a = arguments;\n  return function() {\n      return a;\n  };\n}\n```\n\n今回のプルリクで指摘されたのが`leaksArguments2`と同じケースだった。`arguments`はどこにも漏らしたり渡したりしてはいけないらしい。\n\nつまり`slice.call`や`map`の引数に渡すのはご法度いうわけだ。対処法は以下(mithrilの`m()`でまさに下の実装になっていた)\n\n```javascript\nfunction doesntLeakArguments() {\n                  //.length is just an integer, this doesn't leak\n                  //the arguments object itself\n  var args = new Array(arguments.length);\n  for(var i = 0; i < args.length; ++i) {\n              //i is always valid index in the arguments object\n      args[i] = arguments[i];\n  }\n  return args;\n}\n```\n\n## 3. `arguments`への代入\nこんなことする必要性がないと思うけど、これも例によってsloppyモードの時だけ。\n\n```javascript\nfunction assignToArguments() {\n  arguments = 3;\n  return arguments;\n}\n```\n\n## 結局のところ`arguments`はどうやったら安全に扱えるのか\n以下を厳守すればok\n\n- `arguments.length`使おう。\n- 適切なインデクスアクセスで`arguments`の要素を取得する。で、そいつは外に出さない。\n- `argumets`を**絶対に**直接扱わない。`.length`やインデクスアクセスは`arguments`そのものじゃないからおk。\n- **厳密に言えば**`fn.apply(y, arguments)`はおk。他はいかなる場合もダメ。例えば`.slice`とか。 `Function#apply`だけが特別。\n- `Function#apply`を使って関数のプロパティを追加するときと`Function#bind`で隠れクラスができてしまうような場合に気をつける。\n\n\n# Switch-case\n`switch`文は`case`の節が128を超えると最適化がされなくなる。なので`if-else`使おう。\n\n# For-in\n幾つかの場合で最適化を妨げることになる。\n\n## 1. キーがローカル変数でない場合\n```javascript\nfunction nonLocalKey1() {\n  var obj = {}\n  for(var key in obj);\n  return function() {\n      return key;\n  };\n}\n\nvar key;\nfunction nonLocalKey2() {\n  var obj = {}\n  for(key in obj);\n}\n```\n\nそもそもオブジェクトのキーは上のスコープから参照できない。純粋にローカルスコープの変数でないとダメ。\n\n## 2. イテレートできるようなオブジェクトは'simple enumerable'ではない\n### `hash table mode`(あるいは`normalized objects`, `dictionary mode`)のオブジェクトは'simple enumerable'ではない。\n\n```javascript\nfunction hashTableIteration() {\n  var hashTable = {\"-\": 3};\n  for(var key in hashTable);\n}\n```\n\nこれわかりづらいのだけど、コンストラクタ外で動的に`hash table mode`のオブジェクトを作るのがよくないらしい。\n\nオブジェクトが`hash table mode`になっているかはコード内に`console.log(%HasFastProperties(obj))`を仕込んでnodeのオプションに`--allow-natives-syntax`を指定してやればいいらしい。\n\n\n### プロトタイプチェインで定義されたオブジェクトがenumerableなプロパティを持っている\n\n```javascript\nObject.prototype.fn = function() {};\n```\n\nプロトタイプチェインで追加した値は`for-in`文を含んでしまうらしい。\n\n`Object.defineProperty`を使えばそれは避けられるらしい。慣れていないと難しい話だ。\n\n### 配列のインデクスを持っている\nこれは結構やりがちかもしれない\n\n```javascript\nfunction iteratesOverArray() {\n  var arr = [1, 2, 3];\n  for (var index in arr) {\n\n  }\n}\n```\n\nそもそも`for-in`は`for`より遅いらしい。なおかつ`for-in`を含む関数は含んでいるというそれだけで関数全体の最適化がなされない。\n\nこれらの問題に対する処置としてキー名のリストを作ってしまえということだ。\n\n```javascript\nfunction inheritedKeys(obj) {\n  var ret = [];\n  for(var key in obj) {\n      ret.push(key);\n  }\n  return ret;\n}\n```\n\nまじかよ\n\n\n# 無限ループと曖昧な脱出の条件\n必ず一回はループを通るなら`do-while`使おう。あとはまあロジックを踏まえて適切にexit仕掛けようね。ということらしい。\n\n現場からは以上です。"
}},function(n,t){n.exports={title:"shellのパイプをpythonで実装",slug:"pipe",utime:1458563690,date:"2016/03/21 21:34:50",tags:["python"],publish:!0,body:"なんかふとできるかなと思って試してみたところ以下のような感じになりました。\n\n```python\nclass Pipable:\n    def __init__(self, cmd):\n        if callable(cmd):\n            self.cmd = cmd\n        else:\n            raise ValueError\n\n    def __ror__(self, other):\n        return self.cmd(other)\n\n    def __call__(self, *args):\n        return self.cmd(*args)\n\n\ndef cat(f):\n    with open(f) as fp:\n        data = fp.read()\n    return data\n\n\np1 = Pipable(cat)\np2 = Pipable(lambda x: x.upper())\np3 = Pipable(lambda x: '-'.join(x))\n\n\nraise p1('hoge.txt') == 'neko\\n'\nraise p1('hoge.txt') | p2 == 'NEKO\\n'\nraise p1('hoge.txt') | p2 | p3 == 'N-E-K-O-\\n'\n```\n\n要は`p3(p2(p1('hoge.txt')))`という状態にしてやればいいので(関数合成というやつ？)`__ror__`で左側の処理の結果を受け取るようにしました。\n\n実用性皆無マンです。"}},function(n,t){n.exports={title:"鉄道指向プログラミングをpythonで",slug:"rop",utime:1460642362,date:"2016/04/14 22:59:22",tags:["python"],publish:!0,body:"[Railway oriented programming](http://fsharpforfunandprofit.com/posts/recipe-part2/)を参考にpythonでも鉄道指向プログラミングを実装してみます。\n\nF#全くわらかないけど、どうやら[判別共用体](https://msdn.microsoft.com/ja-jp/library/dd233226.aspx)というやつで処理結果の型を持ち回るということらしいので、そんな風に書いてみます。\n\n```python\nfrom functools import partial\n\n\nclass TSuccess:\n    def __init__(self, result):\n        self.result = result\n\n    def __call__(self):\n        return self.result\n\n\nclass TFailure:\n    def __init__(self, msg):\n        self.msg = msg\n\n    def __call__(self):\n        return lambda : self.msg\n\n\ndef bind(switch_func, two_track_input):\n    if isinstance(two_track_input, TSuccess):\n        return switch_func(two_track_input())\n    elif isinstance(two_track_input, TFailure):\n        return two_track_input\n\n\ndef validate1(inp):\n    if inp.name == '':\n        return TFailure('input name.')\n    else:\n        return TSuccess(inp)\n\n\ndef validate2(inp):\n    if len(inp.name) > 50:\n        return TFailure('name length must be less than 50.')\n    else:\n        return TSuccess(inp)\n\n\ndef validate3(inp):\n    if inp.email == '':\n        return TFailure('input email.')\n    else:\n        return TSuccess(inp)\n\n\nclass Input:\n    def __init__(self, name, email):\n        self._name = name\n        self._email = email\n\n    @property\n    def name(self):\n        return self._name\n\n    @property\n    def email(self):\n        return self._email\n\n    def __call__(self):\n        return 'Success name={}, email={}'.format(self._name, self._email)\n\n\ndef combined_validation(inp):\n    result1 = validate1(inp)\n    result2 = bind(validate2, result1)\n    result3 = bind(validate3, result2)\n    return result3()()\n\n\nassert combined_validation(Input(name='', email='')) == 'input name.'\nassert combined_validation(Input(name='neko', email='')) == 'input email.'\nassert combined_validation(Input(name='neko', email='meow')) == 'Success name=neko, email=meow'\n```\n\nF#では`Result`という判別共用体に`Success`と`Failure`を持っていて、型によってディスパッチするみたいですが、pythonでこれを実現する方法がわからなかった。\n\nというか、これっていわゆるパターンマッチだと思うのでまあそれができればいいかということで`bind`で全てを丸く収めた感があります。"}},function(n,t){n.exports={title:"モジュールグローバルよりクラス変数の方がパフォーマンス的に有利",slug:"module-global-vs-class-variable",utime:1462419084,date:"2016/05/05 12:31:24",tags:["python"],publish:!0,body:"[falcon](http://falconframework.org/)のソース読んでたら[こんなの](https://github.com/falconry/falcon/blob/50fec0fd6dc6e0019099f11a001097e1baccc9ee/falcon/api.py#L128-L135)があった。\n\n```python\n...\n# PERF(kgriffs): Reference via self since that is faster than\n# module global...\n_BODILESS_STATUS_CODES = set([\n    status.HTTP_100,\n    status.HTTP_101,\n    status.HTTP_204,\n    status.HTTP_304\n])\n...\n```\n\nモジュールグローバルのインポートよりもクラス変数のアクセスの方が速いということらしい。\n\nパス探索やらのプロセスがなくなるんだから当たり前だと思うけどどの程度差があるのか気になったのでプロファイルとってみた。\n\n\n`module.py`\n\n```python\nvar = 'I am module global.'\n```\n\n`test.py`\n\n```python\nimport cProfile\n\n\nTRIAL = 100000\n\n\nclass A:\n    var = 'I am class variable'\n\n\ndef test_module_global():\n    for x in range(TRIAL):\n        from mod import var\n\n\ndef test_class_variable():\n    for x in range(TRIAL):\n        a = A()\n        a.var\n\n\nif __name__ == '__main__':\n    cProfile.run('test_module_global()')\n    cProfile.run('test_class_variable()')\n\n```\n\n10万回参照するということがあり得るのかわからないけど、試行回数は10万回とする。\n\n結果から言うと\n\nモジュールグローバルのインポートは\n> 200161 function calls (200160 primitive calls) in 0.185 seconds\n\nクラス変数のアクセスはインスタンスを作るのを含めても\n> 4 function calls in 0.016 seconds\n\nだった。\n\nまあ圧倒的にクラス変数の方が速い。\n\nけどもこれ別モジュールからこのクラスをインポートして使うとかだと大してコスト変わらん気がする。\n\n`falcon.API` は基本的にアプリケーションを実行するためのインスタンスを作るのが目的のオブジェクトなんだろうけどどうせインポートするしなぁ。謎"}},function(n,t){n.exports={title:"ES6で書いたコードをkarma+webpackでテスト",slug:"js-test-with-karma-webpack-es6",utime:1469803820,date:"2016/07/29 23:50:20",tags:["javascript"],publish:!0,body:"`webpack.config.js`がそのまま使えるのでES6向けの設定が非常に楽でした。その割には`karma webpack es6`とかでググっても情報が全然なくて悲しい。\n\n前準備として`npm i -D karam-webpack`をしておきます。\n\n```\n// karama.conf.js\nvar webpackConfig = require('./webpack.config.js');\n\nmodule.exports = function(config) {\n  config.set({\n    basePath: '',\n    frameworks: ['jasmine'],\n    files: [\n      'src/tests/**/*Spec.js'\n    ],\n    exclude: [],\n    preprocessors: {\n      'src/**/*.js': ['webpack'],\n      'src/tests/**/*Spec.js': ['webpack']\n    },\n    webpack: webpackConfig,\n    reporters: ['progress'],\n    port: 9876,\n    colors: true,\n    logLevel: config.LOG_INFO,\n    autoWatch: true,\n    browsers: ['PhantomJS'],\n    singleRun: false,\n    concurrency: Infinity\n  })\n}\n```\n\nこんな設定ファイルを用意して`karma test`を実行するだけでES6で書いたコードのテストが実行できます。\n`webpack.config.js`のエントリポイントをそのまま使っているのでインポートのパス探索を考える必要がないのが良いと思います。\n\n`browserify`の方が楽かと思ったけどこれはこれで問題ないかと。"}},function(n,t){n.exports={title:"mithriljsのコードを読む",slug:"reading-mithriljs",utime:1471866841,date:"2016/08/22 20:54:01",tags:["javascript","mithril"],publish:!0,body:'[mithriljs](https://github.com/lhorie/mithril.js/tree/0159cd667ad85cd82d92fcb31a33f75be6539f6d)のコード読む。\n\n現時点で`v0.2.5`だけど、コアな部分はそう変わらんだろう。コアなというのは、つまり`m.mount`とか。\n\nというわけで`mithril`がレンダリングする`m.mount`から読むことにしよう。(2000行程度なら単体のファイルは読むのが比較的楽ということが知られています)\n\n[ここ](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1475)\n```js\nm.mount = m.module = function (root, component) {\n  if (!root) {\n    throw new Error("Please ensure the DOM element exists before " +\n      "rendering a template into it.")\n  }\n  var index = roots.indexOf(root)\n  if (index < 0) index = roots.length\n  var isPrevented = false\n  var event = {\n    preventDefault: function () {\n      isPrevented = true\n      computePreRedrawHook = computePostRedrawHook = null\n    }\n  }\n  forEach(unloaders, function (unloader) {\n    unloader.handler.call(unloader.controller, event)\n    unloader.controller.onunload = null\n  })\n  if (isPrevented) {\n    forEach(unloaders, function (unloader) {\n      unloader.controller.onunload = unloader.handler\n    })\n  } else {\n    unloaders = []\n  }\n  if (controllers[index] && isFunction(controllers[index].onunload)) {\n    controllers[index].onunload(event)\n  }\n  return checkPrevented(component, root, index, isPrevented)\n}\n```\n`m.mount`がやってることはUnloadableControllerな場合に`unloader`のイベントハンドラを登録しているというだけ。\n注意を払わないといけないのは`event`内で定義されている`preventDefault`関数の中で`isPrevented`を巻き上げてる点だろうか。\n\nまあ、大したことはやっていないので`checkPrevented`を見てみる。\n\n[ここやで](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1437)\n\n```js\nfunction checkPrevented(component, root, index, isPrevented) {\n  if (!isPrevented) {\n    m.redraw.strategy("all")\n    m.startComputation()\n    roots[index] = root\n    var currentComponent\n    if (component) {\n      currentComponent = topComponent = component\n    } else {\n      currentComponent = topComponent = component = {controller: noop}\n    }\n    var controller = new (component.controller || noop)()\n    // controllers may call m.mount recursively (via m.route redirects,\n    // for example)\n    // 訳: controllersはm.mountを再帰的に呼び出し得る。(例えば、m.routeのリダイレクトを通じてとか)\n    // this conditional ensures only the last recursive m.mount call is\n    // applied\n    // 訳: この条件式はm.mountが呼び出す最後の再帰が適用されてるかを確かめてるだけ。\n    if (currentComponent === topComponent) {\n      controllers[index] = controller\n      components[index] = component\n    }\n    endFirstComputation()\n    if (component === null) {\n      removeRootElement(root, index)\n    }\n    return controllers[index]\n  } else {\n    if (component == null) {\n      removeRootElement(root, index)\n    }\n    if (previousRoute) {\n      currentRoute = previousRoute\n    }\n  }\n}\n```\n`isPrevented`でない場合、`m.redraw.strategy`は[`m.prop`](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1553)だから、`all`を初期値としてセット。\n`startComputation`を呼び出しているのでここでredrawのカウンタが始まる。\n\nComponentを作ってからControllerをインスタンス化してる。`currentComponent === topComponent`はよくわからん。`currentComponent = topComponent = ほにゃらら`って必ずどちらも通る分岐に書いてあるし、常にtrueになるんでは？\n\nで、[`endFirstComputation`](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1578)は`endComputation`に読み替えていい。\n\nここでこのDOMの描画のカウンタが終了した。初回の描画はとにかくComponentをインスタンス化するだけのようだ。詳しい描画処理については別の部分を見ないとダメみたいだ。(`endComputation`の`m.redraw`呼び出しなんだけど)\n\nあと、どうやら`m.mount(document.body)`が合法という事らしい。\n\n[`removeRootElement`](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1512)はメソッド名通り、DOM要素からControllerやComponent、仮想DOMのCacheなどを削除している。\n\nところで、描画の処理が全然わからないので続く。'}},function(n,t){n.exports={title:"mithriljsのコードを読む(2)",slug:"reading-mithriljs-2",utime:1472042534,date:"2016/08/24 21:42:14",tags:["javascript","mithril"],publish:!0,body:'さて、前回は`m.mount`の内容を見たところ、描画についてはわからなかった。\n\n`endComputation`内で呼んでいる`m.redraw`の正体を暴こう。\n\n[ここ](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1522)\n```javascript\nm.redraw = function (force) {\n  if (redrawing) return\n  redrawing = true\n  if (force) forcing = true\n  try {\n    // lastRedrawId is a positive number if a second redraw is requested\n    // before the next animation frame\n    // lastRedrawId is null if it\'s the first redraw and not an event\n    // handler\n    // 超意訳: lastRedrawIdはフレームの更新が必要な時に正の数値を持つ。\n    if (lastRedrawId && !force) {\n      // when setTimeout: only reschedule redraw if time between now\n      // and previous redraw is bigger than a frame, otherwise keep\n      // currently scheduled timeout\n      // when rAF: always reschedule redraw\n      // 超意訳: フレームの更新時間が規定を超えていれば更新する\n      if ($requestAnimationFrame === global.requestAnimationFrame ||\n          new Date() - lastRedrawCallTime > FRAME_BUDGET) {\n        if (lastRedrawId > 0) $cancelAnimationFrame(lastRedrawId)\n        lastRedrawId = $requestAnimationFrame(redraw, FRAME_BUDGET)\n      }\n    } else {\n      redraw()\n      lastRedrawId = $requestAnimationFrame(function () {\n        lastRedrawId = null\n      }, FRAME_BUDGET)\n    }\n  } finally {\n    redrawing = forcing = false\n  }\n}\n```\nここではフレームの更新有無を判定している。再描画処理の本体は`redraw`という内部関数のようだ。\n\n[ここ](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1554)\n```javascript\nfunction redraw() {\n  if (computePreRedrawHook) {\n    computePreRedrawHook()\n    computePreRedrawHook = null\n  }\n  forEach(roots, function (root, i) {\n    var component = components[i]\n    if (controllers[i]) {\n      var args = [controllers[i]]\n      m.render(root,\n        component.view ? component.view(controllers[i], args) : "")\n    }\n  })\n  // after rendering within a routed context, we need to scroll back to\n  // the top, and fetch the document title for history.pushState\n  // 訳: routeされているコンテキスト(うまく訳せない)内での描画後、ドキュメントのトップにスクロールする必要がある。\n  //     後history.pushStateするためのドキュメントのタイトルを取得する\n  if (computePostRedrawHook) {\n    computePostRedrawHook()\n    computePostRedrawHook = null\n  }\n  lastRedrawId = null\n  lastRedrawCallTime = new Date()\n  m.redraw.strategy("diff")\n}\n```\n溜め込まれた`roots`のviewを`m.render`に渡している。いよいよ核心に迫ってきた感出てきた。\n\n`computePreRedrawHook`と`computePostRedrawHook`は訳に書いてある処理をやっているだけ。描画が終われば`m.redraw.strategy`がdiffに更新されて、差分だけの更新になるわけだ。\n\n`m.render`を見てみよう。\n\n[ここ](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L1316)\n```javascript\nm.render = function (root, cell, forceRecreation) {\n  if (!root) {\n    throw new Error("Ensure the DOM element being passed to " +\n      "m.route/m.mount/m.render is not undefined.")\n  }\n  var configs = []\n  var id = getCellCacheKey(root)\n  var isDocumentRoot = root === $document\n  var node\n\n  if (isDocumentRoot || root === $document.documentElement) {\n    node = documentNode\n  } else {\n    node = root\n  }\n\n  if (isDocumentRoot && cell.tag !== "html") {\n    cell = {tag: "html", attrs: {}, children: cell}\n  }\n\n  if (cellCache[id] === undefined) clear(node.childNodes)\n  if (forceRecreation === true) reset(root)\n\n  cellCache[id] = build(\n    node,\n    null,\n    undefined,\n    undefined,\n    cell,\n    cellCache[id],\n    false,\n    0,\n    null,\n    undefined,\n    configs)\n\n  forEach(configs, function (config) { config() })\n}\n```\n\nmithrilでは仮想DOMをcellと呼んでいるようで、`getCellCacheKey`はキャッシュされているrootの仮想DOMのidを取得している。\n\nで、nodeはまさにDOMのノードの事(まさに本当の意味でのDOMオブジェクト)で、キャッシュされていないDOMの場合、`clear`を呼び出している。\n\n```javascript\nfunction clear(nodes, cached) {\n  for (var i = nodes.length - 1; i > -1; i--) {\n    if (nodes[i] && nodes[i].parentNode) {\n      try {\n        nodes[i].parentNode.removeChild(nodes[i])\n      } catch (e) {\n        /* eslint-disable max-len */\n        // ignore if this fails due to order of events (see\n        // http://stackoverflow.com/questions/21926083/failed-to-execute-removechild-on-node)\n        /* eslint-enable max-len */\n      }\n      cached = [].concat(cached)\n      if (cached[i]) unload(cached[i])\n    }\n  }\n  // release memory if nodes is an array. This check should fail if nodes\n  // is a NodeList (see loop above)\n  if (nodes.length) {\n    nodes.length = 0\n  }\n}\n```\n\n`clear`は一番後ろの子ノードを親から削除している。ループ処理の対象の長さを変えてしまう倫理観は別の問題として、要するにこれは子ノードを一掃するだけの関数だ。\n\n`m.render`に戻ろう。\n\nようやくたどり着いた`build`がDOM作成の本体だ。\n\nこれがまたしんどそうなので次回'}},function(n,t){n.exports={title:"mithriljsのコードを読む(3)",slug:"reading-mithriljs-3",utime:1472123644,date:"2016/08/25 20:14:04",tags:["javascript","mithril"],publish:!0,body:'`build`の中身読むぞ〜〜〜〜\n\n[ここ](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L916)\n\nまず長いコメントが目を引くのでそれを片付ける。\n```javascript\nfunction build(\n  parentElement,\n  parentTag,\n  parentCache,\n  parentIndex,\n  data,\n  cached,\n  shouldReattach,\n  index,\n  editable,\n  namespace,\n  configs\n) {\n  /*\n   * `build` is a recursive function that manages creation/diffing/removal\n   * of DOM elements based on comparison between `data` and `cached` the\n   * diff algorithm can be summarized as this:\n   *\n   * 1 - compare `data` and `cached`\n   * 2 - if they are different, copy `data` to `cached` and update the DOM\n   *     based on what the difference is\n   * 3 - recursively apply this algorithm for every array and for the\n   *     children of every virtual element\n```\n\nアルゴリズムは以下の通り。\n\n1. `data`と`cached`を比較する\n2. 差分があれば`cached`に`data`をコピーして差分に基づいた更新をDOMに対して行う\n3. 全ての`data`の配列と仮想要素の子に対して上記工程を全て再帰的に適用する\n\nなかなかシンプルだ。そして、差分産出の要となる`data`と`cached`についての説明が続く。\n```javascript\n   * The `cached` data structure is essentially the same as the previous\n   * redraw\'s `data` data structure, with a few additions:\n   * - `cached` always has a property called `nodes`, which is a list of\n   *    DOM elements that correspond to the data represented by the\n   *    respective virtual element\n   * - in order to support attaching `nodes` as a property of `cached`,\n   *    `cached` is *always* a non-primitive object, i.e. if the data was\n   *    a string, then cached is a String instance. If data was `null` or\n   *    `undefined`, cached is `new String("")`\n   * - `cached also has a `configContext` property, which is the state\n   *    storage object exposed by config(element, isInitialized, context)\n   * - when `cached` is an Object, it represents a virtual element; when\n   *    it\'s an Array, it represents a list of elements; when it\'s a\n   *    String, Number or Boolean, it represents a text node\n```\n\n`cached`は前回再描画した`data`のデータ構造と本質的には同じデータ構造である。以下補足。\n- `cached`は常に`nodes`と呼ばれるプロパティを持つ。`nodes`はそれぞれの仮想要素に対応するDOM要素のリストである。\n- `cached`のプロパティとして`nodes`をくっつけられるように`cached`は*常に*プリミティブでないオブジェクトである。(例えば文字列データはcachedにおいてはString型となる。`null`や`undefined`であればcachedは`new String(\'\')`とする)\n- `cached`は`configContext`プロパティも持っている。これは`config`によって作成された状態を保持するためのものである。\n- `cached`がObject型である場合、仮想要素を表している。Array型だった場合は要素のリストであり、String, Number, Boolean型の場合はテキストノードとなる。\n\nつまり、`cached`は純粋なjavascriptの型ではなくDOMオブジェクトとして子ノードを持ちうる状態であることらしい。\n\n以降は残りの引数についてのコメント。\n```javascript\n   * `parentElement` is a DOM element used for W3C DOM API calls\n   * `parentTag` is only used for handling a corner case for textarea\n   * values\n   * `parentCache` is used to remove nodes in some multi-node cases\n   * `parentIndex` and `index` are used to figure out the offset of nodes.\n   * They\'re artifacts from before arrays started being flattened and are\n   * likely refactorable\n   * `data` and `cached` are, respectively, the new and old nodes being\n   * diffed\n   * `shouldReattach` is a flag indicating whether a parent node was\n   * recreated (if so, and if this node is reused, then this node must\n   * reattach itself to the new parent)\n   * `editable` is a flag that indicates whether an ancestor is\n   * contenteditable\n   * `namespace` indicates the closest HTML namespace as it cascades down\n   * from an ancestor\n   * `configs` is a list of config functions to run after the topmost\n   * `build` call finishes running\n   *\n   * there\'s logic that relies on the assumption that null and undefined\n   * data are equivalent to empty strings\n   * - this prevents lifecycle surprises from procedural helpers that mix\n   *   implicit and explicit return statements (e.g.\n   *   function foo() {if (cond) return m("div")}\n   * - it simplifies diffing code\n   */\n```\n| 引数 | 説明 |\n|------|------|\n|parentElement|W3C DOM APIが呼んでいるDOM要素|\n|parentTag|textareaの値の処理の場合にのみ使われる|\n|parentCache|複数のノードが存在する場合にノードを削除するために使われる|\n|parentIndex, index|ノードのオフセットを算出するために使用される|\n|data|差分算出の新しい方|\n|cached|差分算出の古い方|\n|shouldReattach|親ノードを再作成するかしないかを判定するフラグ|\n|editable|祖先の要素がcontenteditableかどうかを判定するフラグ|\n|namespace|直近のHTML名前空間(祖先からカスケードダウンしてくる)|\n|configs|buildの実行が終わった後に動くconfig関数のリスト|\n\nで、この処理でやってることを上から見ていくと`data`がtoStringできるかどうかを判定し、cacheを作り、`data`のデータ型によって処理を分けている。\n\n```javascript\n  data = dataToString(data)\n  if (data.subtree === "retain") return cached\n  cached = makeCache(data, cached, index, parentIndex, parentCache)\n\n  if (isArray(data)) {\n    return buildArray(\n      data,\n      cached,\n      parentElement,\n      index,\n      parentTag,\n      shouldReattach,\n      editable,\n      namespace,\n      configs)\n  } else if (data != null && isObject(data)) {\n    return buildObject(\n      data,\n      cached,\n      editable,\n      parentElement,\n      index,\n      shouldReattach,\n      namespace,\n      configs)\n  } else if (!isFunction(data)) {\n    return handleTextNode(\n      cached,\n      data,\n      index,\n      parentElement,\n      shouldReattach,\n      editable,\n      parentTag)\n  } else {\n    return cached\n  }\n}\n```\n\n- Arrayだったら`buildArray`\n- Objectだったら`buildObject`\n- 上のデータ型でもFunctionでもなかったら`handleTextNode`\n- それでも条件が異なればcachedを返却\n\nとそれぞれ分岐している。\n\n`buildArray`は何をしているんだろう。[ここ](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L584)\n\n```javascript\nfunction buildArray(\n  data,\n  cached,\n  parentElement,\n  index,\n  parentTag,\n  shouldReattach,\n  editable,\n  namespace,\n  configs\n) {\n  data = flatten(data)\n  var nodes = []\n  var intact = cached.length === data.length\n  var subArrayCount = 0\n```\n\n`key`を使うことで余計な要素の再作成を避けている。アルゴリズムはこうだ。\n\n```javascript\n  // keys algorithm: sort elements without recreating them if keys are\n  // present\n  //\n  // 1) create a map of all existing keys, and mark all for deletion\n  // 2) add new keys to map and mark them for addition\n  // 3) if key exists in new list, change action from deletion to a move\n  // 4) for each key, handle its corresponding action as marked in\n  //    previous steps\n```\n\n1. 存在している全てのkeysのマップを作成し、削除処理のためにマークする。\n2. マップに新しいkeysを追加し、それらを追加処理のためにマークする。\n3. keyが新しいリストに存在しているなら、削除処理から移動へとアクションを変更する。\n4. それぞれのkeyについて、ステップ3で決められたマークに対応するアクションを処理する。\n\nわかるようでイマイチわからないので大人しくコードを読み進める。\n\n```javascript\n  var existing = {}\n  var shouldMaintainIdentities = false\n\n  forKeys(cached, function (attrs, i) {\n    shouldMaintainIdentities = true\n    existing[cached[i].attrs.key] = {action: DELETION, index: i}\n  })\n```\n\nなるほど、`cached`をループして、アクションを`DELTION`に設定している。ステップ1だ。\n\n```javascript\n  buildArrayKeys(data)\n```\n\n今度は`buildArrayKeys`ですか(;´Д`)\n```javascript\nfunction buildArrayKeys(data) {\n  var guid = 0\n  forKeys(data, function () {\n    forEach(data, function (attrs) {\n      if ((attrs = attrs && attrs.attrs) && attrs.key == null) {\n        attrs.key = "__mithril__" + guid++\n      }\n    })\n    return 1\n  })\n}\n```\n\n`data`の属性をループして`key`が設定されていなければ識別子として設定している。ステップ2だ。\n\nで、`cached`が存在してさえいれば`diffKeys`を呼んで終わり。\n\n```javascript\n  if (shouldMaintainIdentities) {\n    cached = diffKeys(data, cached, existing, parentElement)\n  }\n  // end key algorithm\n```\n\nだるい\n\n```javascript\nfunction diffKeys(data, cached, existing, parentElement) {\n  var keysDiffer = data.length !== cached.length\n\n  if (!keysDiffer) {\n    forKeys(data, function (attrs, i) {\n      var cachedCell = cached[i]\n      return keysDiffer = cachedCell &&\n        cachedCell.attrs &&\n        cachedCell.attrs.key !== attrs.key\n    })\n  }\n\n  if (keysDiffer) {\n    return handleKeysDiffer(data, existing, cached, parentElement)\n  } else {\n    return cached\n  }\n}\n```\n\n`data`と`cached`の要素数が同じであれば`cached`と`data`の`key`が違うかどうかを判定しcachedをそのまま返却。\n\nそうでなければ`handleKeysDiffer`を呼び出して返却値をそのまま返却。しんどい\n\n```javascript\nfunction handleKeysDiffer(data, existing, cached, parentElement) {\n  forKeys(data, function (key, i) {\n    existing[key = key.key] = existing[key] ? {\n      action: MOVE,\n      index: i,\n      from: existing[key].index,\n      element: cached.nodes[existing[key].index] ||\n        $document.createElement("div")\n    } : {action: INSERTION, index: i}\n  })\n```\n\n`data`の`key`がすでに存在している場合は`MOVE`のアクションが与えられている。`element`が`cached`の`nodes`が持つ要素か、新規作成のdiv要素になっている。\n\n`data`の`key`がまだ存在していなければ`INSERTION`のアクションが与えられている。\n\nで、actionsにexistingのプロパティの値を溜め込んで\n\n```javascript\n  var actions = []\n  for (var prop in existing) {\n    if (hasOwn.call(existing, prop)) {\n      actions.push(existing[prop])\n    }\n  }\n```\n\nアクションごとに処理してる。\n\n```javascript\n  var changes = actions.sort(sortChanges)\n  var newCached = new Array(cached.length)\n\n  newCached.nodes = cached.nodes.slice()\n\n  forEach(changes, function (change) {\n    var index = change.index\n    if (change.action === DELETION) {\n      clear(cached[index].nodes, cached[index])\n      newCached.splice(index, 1)\n    }\n    if (change.action === INSERTION) {\n      var dummy = $document.createElement("div")\n      dummy.key = data[index].attrs.key\n      insertNode(parentElement, dummy, index)\n      newCached.splice(index, 0, {\n        attrs: {key: data[index].attrs.key},\n        nodes: [dummy]\n      })\n      newCached.nodes[index] = dummy\n    }\n\n    if (change.action === MOVE) {\n      var changeElement = change.element\n      var maybeChanged = parentElement.childNodes[index]\n      if (maybeChanged !== changeElement && changeElement !== null) {\n        parentElement.insertBefore(changeElement,\n          maybeChanged || null)\n      }\n      newCached[index] = cached[change.from]\n      newCached.nodes[index] = changeElement\n    }\n  })\n```\n\n大して難しいことしてない。`newCached`で`cache`を更新し、アクションごとに削除、追加、移動をしている。\n\nで、戻ってくる。\n\n```javascript\n  var cacheCount = 0\n  // faster explicitly written\n  for (var i = 0, len = data.length; i < len; i++) {\n    // diff each item in the array\n    var item = build(\n      parentElement,\n      parentTag,\n      cached,\n      index,\n      data[i],\n      cached[cacheCount],\n      shouldReattach,\n      index + subArrayCount || subArrayCount,\n      editable,\n      namespace,\n      configs)\n\n    if (item !== undefined) {\n      intact = intact && item.nodes.intact\n      subArrayCount += getSubArrayCount(item)\n      cached[cacheCount++] = item\n    }\n  }\n\n  if (!intact) diffArray(data, cached, nodes)\n  return cached\n}\n```\n\n`data`の要素に対して`build`を呼び出し再帰処理している。　\n\n最後の`diffArray`は`data`と`cached`の長さが異なる場合に呼ばれ、内容としては`nodes`から`cached`の要素を削除して`data`の長さに合わせている。\n\n`cached`に残っている不要な要素を削除する目的のようだ。\n\nまだ全然終わらんが、疲れたので続く'}},function(n,t){n.exports={title:"mithriljsのコードを読む(4)",slug:"reading-mithriljs-4",utime:1472296703,date:"2016/08/27 20:18:23",tags:["javascript","mithril"],publish:!0,body:'前回は`buildArray`まで読んだ。`buildObject`から読もうではないか。\n\n[ここ](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L831)\n\n```javascript\nfunction buildObject( // eslint-disable-line max-statements\n  data,\n  cached,\n  editable,\n  parentElement,\n  index,\n  shouldReattach,\n  namespace,\n  configs\n) {\n  var views = []\n  var controllers = []\n\n  data = markViews(data, cached, views, controllers)\n```\n\n`data`がオブジェクトの場合、つまりコンポーネントの場合は`markViews`で何かをしている。見てみる。\n\n```javascript\nfunction markViews(data, cached, views, controllers) {\n  var cachedControllers = cached && cached.controllers\n\n  while (data.view != null) {\n    data = checkView(\n      data,\n      data.view.$original || data.view,\n      cached,\n      cachedControllers,\n      controllers,\n      views)\n  }\n\n  return data\n```\n\nキャッシュされているControllerがないかを判定して`checkView`から`data`を作っている。見てみる。\n\n```javascript\nfunction checkView(\n  data,\n  view,\n  cached,\n  cachedControllers,\n  controllers,\n  views\n) {\n  var controller = getController(\n    cached.views,\n    view,\n    cachedControllers,\n    data.controller)\n\n  var key = data && data.attrs && data.attrs.key\n```\nバケツリレーで頭がフットーしそうだが、`getController`でControllerを取得しているのは明白だ。さらに、`data`の`key`を取得している。\n\nこの辺はキャッシュされている仮想DOMをアレコレするためだろう。`getController`を見てみる。\n\n```javascript\nfunction getController(views, view, cachedControllers, controller) {\n  var controllerIndex\n\n  if (m.redraw.strategy() === "diff" && views) {\n    controllerIndex = views.indexOf(view)\n  } else {\n    controllerIndex = -1\n  }\n\n  if (controllerIndex > -1) {\n    return cachedControllers[controllerIndex]\n  } else if (isFunction(controller)) {\n    return new controller()\n  } else {\n    return {}\n  }\n}\n```\n\n差分描画のフラグで且つコンポーネントが作成されていればキャッシュされているControllerを返し、そうでなければ引数の`controller`をインスタンス化するか空のオブジェクトを返す。\n\nまあその名の通りControllerを返しているだけだ。\n\n`checkView`に戻ると\n\n```javascript\n  if (pendingRequests === 0 ||\n      forcing ||\n      cachedControllers &&\n        cachedControllers.indexOf(controller) > -1) {\n    data = data.view(controller)\n  } else {\n    data = {tag: "placeholder"}\n  }\n```\n\nこのif文は再描画を行える状態かキャッシュされているControllerが存在している場合に仮想DOM(`data.view`のreturn)を`data`に再代入している。\n\n```javascript\n\n  if (data.subtree === "retain") return data\n  data.attrs = data.attrs || {}\n  data.attrs.key = key\n  updateLists(views, controllers, view, controller)\n  return data\n}\n```\n\n`data.subtree === "retain"`であれば`data`の更新は行わない。ここは[ドキュメントにひっそりと書いてある。](http://mithril.js.org/mithril.html#persisting-dom-elements-across-route-changes)\n\n概要を書くと、retainが設定されていると`router`による画面再描画時にそのDOMは再構築されずにそのまま引き継がれるというもの。\nコンポーネントを使い回す時などに設定することになる。(この文脈でコンポーネントは`data`のこと)\n\nで、コンポーネントをキャッシュしている`views`と`controllers`に作成した`view`と`controller`突っ込んでいる。\n\n`buildObject`に戻ります。\n\n```javascript\n  if (data.subtree === "retain") return cached\n```\n\n上述した通り、retainの時はコンポーネントを使い回す。\n\n```javascript\n\n  if (!data.tag && controllers.length) {\n    throw new Error("Component template must return a virtual " +\n      "element, not an array, string, etc.")\n  }\n\n  data.attrs = data.attrs || {}\n  cached.attrs = cached.attrs || {}\n\n  var dataAttrKeys = Object.keys(data.attrs)\n  var hasKeys = dataAttrKeys.length > ("key" in data.attrs ? 1 : 0)\n\n  maybeRecreateObject(data, cached, dataAttrKeys)\n```\n\nここからはconfigの設定かな。`maybeRecreateObject`を見てみる。\n\n```javascript\nfunction maybeRecreateObject(data, cached, dataAttrKeys) {\n  // if an element is different enough from the one in cache, recreate it\n  if (isDifferentEnough(data, cached, dataAttrKeys)) {\n    if (cached.nodes.length) clear(cached.nodes)\n\n    if (cached.configContext &&\n        isFunction(cached.configContext.onunload)) {\n      cached.configContext.onunload()\n    }\n\n    if (cached.controllers) {\n      forEach(cached.controllers, function (controller) {\n        if (controller.onunload) {\n          controller.onunload({preventDefault: noop})\n        }\n      })\n    }\n  }\n}\n```\n\n差分があった時に再作成するような要素だった場合に再作成している。で、`diffrent enough`であることを`isDifferentEnough`で見ている。\n\n```javascript\nfunction isDifferentEnough(data, cached, dataAttrKeys) {\n  if (data.tag !== cached.tag) return true\n\n  if (dataAttrKeys.sort().join() !==\n      Object.keys(cached.attrs).sort().join()) {\n    return true\n  }\n\n  if (data.attrs.id !== cached.attrs.id) {\n    return true\n  }\n\n  if (data.attrs.key !== cached.attrs.key) {\n    return true\n  }\n\n  if (m.redraw.strategy() === "all") {\n    return !cached.configContext || cached.configContext.retain !== true\n  }\n\n  if (m.redraw.strategy() === "diff") {\n    return cached.configContext && cached.configContext.retain === false\n  }\n\n  return false\n}\n```\n\ntrueになるのは\n- attributesのキーがキャッシュされているのと異なる時\n- attrsのidがキャッシュされているのと異なる時\n- `key`がキャッシュされているのと異なる時\n- strategyが`all`でかつ、`config`がないまたはretainが設定されていない時\n- strategyが`diff`でかつ、`config`があってretainが設定されていない時\n\nちなみに、strategyは↓の通り\n| all | デフォルトの値。redrawのタイミングで現在のDOMを捨てて全部作り直す|\n| diff | 差分があったときだけその差分更新を行う |\n| none | redrawをすっ飛ばす。何も更新はしない |\n\n`all`でかつ`config`がない時というのがピンとこないが、おそらく`config`は`redraw`のタイミングで常に呼ばれるからキャッシュ前提のためだろう。\n\n```javascript\n\n  if (!isString(data.tag)) return\n```\n\nここはどういうことだかよくわからない。`tag`が文字型でなければエラーではなく無を返す…どういうことだ…\n\n[m()ではエラーにしてるぞ?](https://github.com/lhorie/mithril.js/blob/0159cd667ad85cd82d92fcb31a33f75be6539f6d/mithril.js#L168-L171)\n\nよくわからないのでgitterで聞いてる中。\n\n```javascript\n  var isNew = cached.nodes.length === 0\n\n  namespace = getObjectNamespace(data, namespace)\n  var node\n  if (isNew) {\n    node = constructNode(data, namespace)\n```\nここでDOM作ってる。\n\n```javascript\n    // set attributes first, then create children\n    var attrs = constructAttrs(data, node, namespace, hasKeys)\n```\n\nDOMにアトリビュートをセット\n\n```javascript\n    // add the node to its parent before attaching children to it\n    insertNode(parentElement, node, index)\n```\n\n子ノードとして親要素に追加\n\n```javascript\n    var children = constructChildren(data, node, cached, editable,\n      namespace, configs)\n```\n\n子ノードを作成。この中でさらに`build`を呼んで子ノードのDOMを作成している。\n\n```javascript\n    cached = reconstructCached(\n      data,\n      attrs,\n      children,\n      node,\n      namespace,\n      views,\n      controllers)\n  } else {\n    node = buildUpdatedNode(\n      cached,\n      data,\n      editable,\n      hasKeys,\n      namespace,\n      views,\n      configs,\n      controllers)\n  }\n\n```\n\n初回の`build`であればキャッシュを作り、そうでなければ`data`の情報で`cached`を更新する。\n\n```javascript\n  // edge case: setting value on <select> doesn\'t work before children\n  // exist, so set it again after children have been created/updated\n  if (data.tag === "select" && "value" in data.attrs) {\n    setAttributes(node, data.tag, {value: data.attrs.value}, {},\n      namespace)\n  }\n  if (!isNew && shouldReattach === true && node != null) {\n    insertNode(parentElement, node, index)\n  }\n\n  // The configs are called after `build` finishes running\n  scheduleConfigsToBeCalled(configs, data, node, isNew, cached)\n\n  return cached\n}\n```\nどうやらselectタグが指定されていた場合は子要素がないとうまく動かないとのことでもう一度属性の設定をしている。\n\nで、必要に応じて`node`を`index`の位置に追加して最後に`data`の`config`を`configs`に突っ込んで終了。\n\n\nとりあえずこれでおしまいなんだが、まだあるんや…'
}},function(n,t){n.exports="2016/08/27/reading-mithriljs-4.yml 2016/08/25/reading-mithriljs-3.yml 2016/08/24/reading-mithriljs-2.yml 2016/08/22/reading-mithriljs.yml 2016/07/29/js-test-with-karma-webpack-es6.yml 2016/05/05/module-global-vs-class-variable.yml 2016/04/14/rop.yml 2016/03/21/pipe.yml 2016/03/19/v8-optimization.yml 2016/03/13/pyazo.yml 2016/02/26/expert-python-chapter3.yml 2016/02/21/mithrilify.yml 2016/02/14/moved-to-gh-page.yml"},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(n){var t=n.props;return(0,o["default"])("div#article-list-wrapper",[(0,o["default"])("div#article-list",t.map(function(n){return(0,o["default"])("div.title",[(0,o["default"])("a[href='/blog/article/"+n.href+"']",{config:o["default"].route},n.title),(0,o["default"])("span.post-date","("+n.date+")")])})),(0,o["default"])("div#footer-trans"),(0,o["default"])("div#footer",[(0,o["default"])('a[href="/"]',{config:o["default"].route},(0,o["default"])('img[src="../../../../assets/img/avatar.png"]'))])])}Object.defineProperty(t,"__esModule",{value:!0});var a=e(1),o=r(a);t["default"]=i},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}Object.defineProperty(t,"__esModule",{value:!0});var i=e(29),a=r(i),o=e(31),u=r(o);t["default"]={controller:a["default"],view:u["default"]}},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(){return{data:(0,l["default"])(o["default"].route.param("date"),o["default"].route.param("slug"))}}Object.defineProperty(t,"__esModule",{value:!0});var a=e(1),o=r(a),u=e(30),l=r(u);t["default"]=i},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(n,t){var e=o["default"].parseYaml(),r=l["default"].compact(e.map(function(e){return e.date.split(" ")[0]===n&&e.slug===t?e:void 0}));return r[0]}Object.defineProperty(t,"__esModule",{value:!0});var a=e(9),o=r(a),u=e(10),l=r(u);t["default"]=i},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(n){var t=n.data;return(0,o["default"])("section",[(0,o["default"])("header",[(0,o["default"])("h1",t.title),(0,o["default"])("div#description",t.description),(0,o["default"])("div#article-date",[(0,o["default"])('span.glyphicon.glyphicon-time[aria-hidden="true"]'),t.date]),(0,o["default"])("div#tags",t.tags.map(function(n){return(0,o["default"])("span.tag",(0,o["default"])("a[href='/blog/tag/"+n+"']",{config:o["default"].route},[(0,o["default"])('span.glyphicon.glyphicon-tag[aria-hidden="true"]'),n]))}))]),(0,o["default"])("article",[(0,o["default"])("div#utime='"+t.utime+"'",o["default"].trust((0,l["default"])(t.body)))]),(0,o["default"])("footer",[(0,o["default"])("div#back",[(0,o["default"])('a.btn.btn-default[href="/blog/"]',{config:o["default"].route},"back")])])])}Object.defineProperty(t,"__esModule",{value:!0});var a=e(1),o=r(a),u=e(32),l=r(u);l["default"].setOptions({gfm:!0}),t["default"]=i},function(n,t,e){(function(t){(function(){function t(n){this.tokens=[],this.tokens.links={},this.options=n||s.defaults,this.rules=f.normal,this.options.gfm&&(this.options.tables?this.rules=f.tables:this.rules=f.gfm)}function e(n,t){if(this.options=t||s.defaults,this.links=n,this.rules=d.normal,this.renderer=this.options.renderer||new r,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=d.breaks:this.rules=d.gfm:this.options.pedantic&&(this.rules=d.pedantic)}function r(n){this.options=n||{}}function i(n){this.tokens=[],this.token=null,this.options=n||s.defaults,this.options.renderer=this.options.renderer||new r,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(n,t){return n.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function o(n){return n.replace(/&([#\w]+);/g,function(n,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function u(n,t){return n=n.source,t=t||"",function e(r,i){return r?(i=i.source||i,i=i.replace(/(^|[^\[])\^/g,"$1"),n=n.replace(r,i),e):new RegExp(n,t)}}function l(){}function c(n){for(var t,e,r=1;r<arguments.length;r++){t=arguments[r];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n}function s(n,e,r){if(r||"function"==typeof e){r||(r=e,e=null),e=c({},s.defaults,e||{});var o,u,l=e.highlight,f=0;try{o=t.lex(n,e)}catch(d){return r(d)}u=o.length;var h=function(n){if(n)return e.highlight=l,r(n);var t;try{t=i.parse(o,e)}catch(a){n=a}return e.highlight=l,n?r(n):r(null,t)};if(!l||l.length<3)return h();if(delete e.highlight,!u)return h();for(;f<o.length;f++)!function(n){return"code"!==n.type?--u||h():l(n.text,n.lang,function(t,e){return t?h(t):null==e||e===n.text?--u||h():(n.text=e,n.escaped=!0,void(--u||h()))})}(o[f])}else try{return e&&(e=c({},s.defaults,e)),i.parse(t.lex(n,e),e)}catch(d){if(d.message+="\nPlease report this to https://github.com/chjj/marked.",(e||s.defaults).silent)return"<p>An error occured:</p><pre>"+a(d.message+"",!0)+"</pre>";throw d}}var f={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:l,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:l,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:l,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};f.bullet=/(?:[*+-]|\d+\.)/,f.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,f.item=u(f.item,"gm")(/bull/g,f.bullet)(),f.list=u(f.list)(/bull/g,f.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+f.def.source+")")(),f.blockquote=u(f.blockquote)("def",f.def)(),f._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",f.html=u(f.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,f._tag)(),f.paragraph=u(f.paragraph)("hr",f.hr)("heading",f.heading)("lheading",f.lheading)("blockquote",f.blockquote)("tag","<"+f._tag)("def",f.def)(),f.normal=c({},f),f.gfm=c({},f.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),f.gfm.paragraph=u(f.paragraph)("(?!","(?!"+f.gfm.fences.source.replace("\\1","\\2")+"|"+f.list.source.replace("\\1","\\3")+"|")(),f.tables=c({},f.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=f,t.lex=function(n,e){var r=new t(e);return r.lex(n)},t.prototype.lex=function(n){return n=n.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(n,!0)},t.prototype.token=function(n,t,e){for(var r,i,a,o,u,l,c,s,d,n=n.replace(/^ +$/gm,"");n;)if((a=this.rules.newline.exec(n))&&(n=n.substring(a[0].length),a[0].length>1&&this.tokens.push({type:"space"})),a=this.rules.code.exec(n))n=n.substring(a[0].length),a=a[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?a:a.replace(/\n+$/,"")});else if(a=this.rules.fences.exec(n))n=n.substring(a[0].length),this.tokens.push({type:"code",lang:a[2],text:a[3]||""});else if(a=this.rules.heading.exec(n))n=n.substring(a[0].length),this.tokens.push({type:"heading",depth:a[1].length,text:a[2]});else if(t&&(a=this.rules.nptable.exec(n))){for(n=n.substring(a[0].length),l={type:"table",header:a[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3].replace(/\n$/,"").split("\n")},s=0;s<l.align.length;s++)/^ *-+: *$/.test(l.align[s])?l.align[s]="right":/^ *:-+: *$/.test(l.align[s])?l.align[s]="center":/^ *:-+ *$/.test(l.align[s])?l.align[s]="left":l.align[s]=null;for(s=0;s<l.cells.length;s++)l.cells[s]=l.cells[s].split(/ *\| */);this.tokens.push(l)}else if(a=this.rules.lheading.exec(n))n=n.substring(a[0].length),this.tokens.push({type:"heading",depth:"="===a[2]?1:2,text:a[1]});else if(a=this.rules.hr.exec(n))n=n.substring(a[0].length),this.tokens.push({type:"hr"});else if(a=this.rules.blockquote.exec(n))n=n.substring(a[0].length),this.tokens.push({type:"blockquote_start"}),a=a[0].replace(/^ *> ?/gm,""),this.token(a,t,!0),this.tokens.push({type:"blockquote_end"});else if(a=this.rules.list.exec(n)){for(n=n.substring(a[0].length),o=a[2],this.tokens.push({type:"list_start",ordered:o.length>1}),a=a[0].match(this.rules.item),r=!1,d=a.length,s=0;d>s;s++)l=a[s],c=l.length,l=l.replace(/^ *([*+-]|\d+\.) +/,""),~l.indexOf("\n ")&&(c-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&s!==d-1&&(u=f.bullet.exec(a[s+1])[0],o===u||o.length>1&&u.length>1||(n=a.slice(s+1).join("\n")+n,s=d-1)),i=r||/\n\n(?!\s*$)/.test(l),s!==d-1&&(r="\n"===l.charAt(l.length-1),i||(i=r)),this.tokens.push({type:i?"loose_item_start":"list_item_start"}),this.token(l,!1,e),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(a=this.rules.html.exec(n))n=n.substring(a[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===a[1]||"script"===a[1]||"style"===a[1]),text:a[0]});else if(!e&&t&&(a=this.rules.def.exec(n)))n=n.substring(a[0].length),this.tokens.links[a[1].toLowerCase()]={href:a[2],title:a[3]};else if(t&&(a=this.rules.table.exec(n))){for(n=n.substring(a[0].length),l={type:"table",header:a[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3].replace(/(?: *\| *)?\n$/,"").split("\n")},s=0;s<l.align.length;s++)/^ *-+: *$/.test(l.align[s])?l.align[s]="right":/^ *:-+: *$/.test(l.align[s])?l.align[s]="center":/^ *:-+ *$/.test(l.align[s])?l.align[s]="left":l.align[s]=null;for(s=0;s<l.cells.length;s++)l.cells[s]=l.cells[s].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(t&&(a=this.rules.paragraph.exec(n)))n=n.substring(a[0].length),this.tokens.push({type:"paragraph",text:"\n"===a[1].charAt(a[1].length-1)?a[1].slice(0,-1):a[1]});else if(a=this.rules.text.exec(n))n=n.substring(a[0].length),this.tokens.push({type:"text",text:a[0]});else if(n)throw new Error("Infinite loop on byte: "+n.charCodeAt(0));return this.tokens};var d={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:l,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:l,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};d._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,d._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,d.link=u(d.link)("inside",d._inside)("href",d._href)(),d.reflink=u(d.reflink)("inside",d._inside)(),d.normal=c({},d),d.pedantic=c({},d.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),d.gfm=c({},d.normal,{escape:u(d.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:u(d.text)("]|","~]|")("|","|https?://|")()}),d.breaks=c({},d.gfm,{br:u(d.br)("{2,}","*")(),text:u(d.gfm.text)("{2,}","*")()}),e.rules=d,e.output=function(n,t,r){var i=new e(t,r);return i.output(n)},e.prototype.output=function(n){for(var t,e,r,i,o="";n;)if(i=this.rules.escape.exec(n))n=n.substring(i[0].length),o+=i[1];else if(i=this.rules.autolink.exec(n))n=n.substring(i[0].length),"@"===i[2]?(e=":"===i[1].charAt(6)?this.mangle(i[1].substring(7)):this.mangle(i[1]),r=this.mangle("mailto:")+e):(e=a(i[1]),r=e),o+=this.renderer.link(r,null,e);else if(this.inLink||!(i=this.rules.url.exec(n))){if(i=this.rules.tag.exec(n))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),n=n.substring(i[0].length),o+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):a(i[0]):i[0];else if(i=this.rules.link.exec(n))n=n.substring(i[0].length),this.inLink=!0,o+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(n))||(i=this.rules.nolink.exec(n))){if(n=n.substring(i[0].length),t=(i[2]||i[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){o+=i[0].charAt(0),n=i[0].substring(1)+n;continue}this.inLink=!0,o+=this.outputLink(i,t),this.inLink=!1}else if(i=this.rules.strong.exec(n))n=n.substring(i[0].length),o+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(n))n=n.substring(i[0].length),o+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(n))n=n.substring(i[0].length),o+=this.renderer.codespan(a(i[2],!0));else if(i=this.rules.br.exec(n))n=n.substring(i[0].length),o+=this.renderer.br();else if(i=this.rules.del.exec(n))n=n.substring(i[0].length),o+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(n))n=n.substring(i[0].length),o+=this.renderer.text(a(this.smartypants(i[0])));else if(n)throw new Error("Infinite loop on byte: "+n.charCodeAt(0))}else n=n.substring(i[0].length),e=a(i[1]),r=e,o+=this.renderer.link(r,null,e);return o},e.prototype.outputLink=function(n,t){var e=a(t.href),r=t.title?a(t.title):null;return"!"!==n[0].charAt(0)?this.renderer.link(e,r,this.output(n[1])):this.renderer.image(e,r,a(n[1]))},e.prototype.smartypants=function(n){return this.options.smartypants?n.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):n},e.prototype.mangle=function(n){if(!this.options.mangle)return n;for(var t,e="",r=n.length,i=0;r>i;i++)t=n.charCodeAt(i),Math.random()>.5&&(t="x"+t.toString(16)),e+="&#"+t+";";return e},r.prototype.code=function(n,t,e){if(this.options.highlight){var r=this.options.highlight(n,t);null!=r&&r!==n&&(e=!0,n=r)}return t?'<pre><code class="'+this.options.langPrefix+a(t,!0)+'">'+(e?n:a(n,!0))+"\n</code></pre>\n":"<pre><code>"+(e?n:a(n,!0))+"\n</code></pre>"},r.prototype.blockquote=function(n){return"<blockquote>\n"+n+"</blockquote>\n"},r.prototype.html=function(n){return n},r.prototype.heading=function(n,t,e){return"<h"+t+' id="'+this.options.headerPrefix+e.toLowerCase().replace(/[^\w]+/g,"-")+'">'+n+"</h"+t+">\n"},r.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},r.prototype.list=function(n,t){var e=t?"ol":"ul";return"<"+e+">\n"+n+"</"+e+">\n"},r.prototype.listitem=function(n){return"<li>"+n+"</li>\n"},r.prototype.paragraph=function(n){return"<p>"+n+"</p>\n"},r.prototype.table=function(n,t){return"<table>\n<thead>\n"+n+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},r.prototype.tablerow=function(n){return"<tr>\n"+n+"</tr>\n"},r.prototype.tablecell=function(n,t){var e=t.header?"th":"td",r=t.align?"<"+e+' style="text-align:'+t.align+'">':"<"+e+">";return r+n+"</"+e+">\n"},r.prototype.strong=function(n){return"<strong>"+n+"</strong>"},r.prototype.em=function(n){return"<em>"+n+"</em>"},r.prototype.codespan=function(n){return"<code>"+n+"</code>"},r.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},r.prototype.del=function(n){return"<del>"+n+"</del>"},r.prototype.link=function(n,t,e){if(this.options.sanitize){try{var r=decodeURIComponent(o(n)).replace(/[^\w:]/g,"").toLowerCase()}catch(i){return""}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:"))return""}var a='<a href="'+n+'"';return t&&(a+=' title="'+t+'"'),a+=">"+e+"</a>"},r.prototype.image=function(n,t,e){var r='<img src="'+n+'" alt="'+e+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},r.prototype.text=function(n){return n},i.parse=function(n,t,e){var r=new i(t,e);return r.parse(n)},i.prototype.parse=function(n){this.inline=new e(n.links,this.options,this.renderer),this.tokens=n.reverse();for(var t="";this.next();)t+=this.tok();return t},i.prototype.next=function(){return this.token=this.tokens.pop()},i.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},i.prototype.parseText=function(){for(var n=this.token.text;"text"===this.peek().type;)n+="\n"+this.next().text;return this.inline.output(n)},i.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var n,t,e,r,i,a="",o="";for(e="",n=0;n<this.token.header.length;n++)r={header:!0,align:this.token.align[n]},e+=this.renderer.tablecell(this.inline.output(this.token.header[n]),{header:!0,align:this.token.align[n]});for(a+=this.renderer.tablerow(e),n=0;n<this.token.cells.length;n++){for(t=this.token.cells[n],e="",i=0;i<t.length;i++)e+=this.renderer.tablecell(this.inline.output(t[i]),{header:!1,align:this.token.align[i]});o+=this.renderer.tablerow(e)}return this.renderer.table(a,o);case"blockquote_start":for(var o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":for(var o="",u=this.token.ordered;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,u);case"list_item_start":for(var o="";"list_item_end"!==this.next().type;)o+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(o);case"loose_item_start":for(var o="";"list_item_end"!==this.next().type;)o+=this.tok();return this.renderer.listitem(o);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},l.exec=l,s.options=s.setOptions=function(n){return c(s.defaults,n),s},s.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new r,xhtml:!1},s.Parser=i,s.parser=i.parse,s.Renderer=r,s.Lexer=t,s.lexer=t.lex,s.InlineLexer=e,s.inlineLexer=e.output,s.parse=s,n.exports=s}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(t,function(){return this}())},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}Object.defineProperty(t,"__esModule",{value:!0});var i=e(34),a=r(i),o=e(37),u=r(o);t["default"]={controller:a["default"],view:u["default"]}},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(){return{props:(0,l["default"])(o["default"].route.param("name"))}}Object.defineProperty(t,"__esModule",{value:!0});var a=e(1),o=r(a),u=e(35),l=r(u);t["default"]=i},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(n){return{tag:n,data:o["default"][n]}}Object.defineProperty(t,"__esModule",{value:!0});var a=e(36),o=r(a);t["default"]=i},function(n,t){n.exports={javascript:[{path:"2016/08/27/reading-mithriljs-4",title:"mithriljsのコードを読む(4)"},{path:"2016/08/25/reading-mithriljs-3",title:"mithriljsのコードを読む(3)"},{path:"2016/08/24/reading-mithriljs-2",title:"mithriljsのコードを読む(2)"},{path:"2016/08/22/reading-mithriljs",title:"mithriljsのコードを読む"},{path:"2016/07/29/js-test-with-karma-webpack-es6",title:"ES6で書いたコードをkarma+webpackでテスト"},{path:"2016/03/19/v8-optimization",title:"V8で最適化されないjavascript"},{path:"2016/02/21/mithrilify",title:"github pagesの構成を変えた"}],misc:[{path:"2016/02/14/moved-to-gh-page",title:"github pagesに引越し"}],mithril:[{path:"2016/08/27/reading-mithriljs-4",title:"mithriljsのコードを読む(4)"},{path:"2016/08/25/reading-mithriljs-3",title:"mithriljsのコードを読む(3)"},{path:"2016/08/24/reading-mithriljs-2",title:"mithriljsのコードを読む(2)"},{path:"2016/08/22/reading-mithriljs",title:"mithriljsのコードを読む"},{path:"2016/02/21/mithrilify",title:"github pagesの構成を変えた"}],python:[{path:"2016/05/05/module-global-vs-class-variable",title:"モジュールグローバルよりクラス変数の方がパフォーマンス的に有利"},{path:"2016/04/14/rop",title:"鉄道指向プログラミングをpythonで"},{path:"2016/03/21/pipe",title:"shellのパイプをpythonで実装"},{path:"2016/03/13/pyazo",title:"Gyazo APIのクライアントを雑に作った"},{path:"2016/02/26/expert-python-chapter3",title:"pythonの__new__とかtypeなど"},{path:"2016/02/21/mithrilify",title:"github pagesの構成を変えた"}],webpack:[{path:"2016/02/21/mithrilify",title:"github pagesの構成を変えた"}]}},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function i(n){var t=n.props;return(0,o["default"])("div",[(0,o["default"])("div#tag-header",(0,o["default"])("h2",[(0,o["default"])('span.glyphicon.glyphicon-tag[aria-hidden="true"]'),t.tag])),(0,o["default"])("div#tag-list",t.data.map(function(n){return(0,o["default"])("div",[(0,o["default"])("a[href='/blog/article/"+n.path+"']",{config:o["default"].route},n.title)])}))])}Object.defineProperty(t,"__esModule",{value:!0});var a=e(1),o=r(a);t["default"]=i}]);